; constants needed by executor C++
CONST %N = 2**19
CONST %MAX_CNT_STEPS_LIMIT = %N
CONST %MAX_CNT_ARITH_LIMIT = %N
CONST %MAX_CNT_BINARY_LIMIT = %N
CONST %MAX_CNT_MEM_ALIGN_LIMIT = %N
CONST %MAX_CNT_KECCAK_F_LIMIT = %N
CONST %MAX_CNT_PADDING_PG_LIMIT = %N
CONST %MAX_CNT_POSEIDON_G_LIMIT = %N

VAR GLOBAL lastHashKId
VAR GLOBAL lastHashPId

VAR GLOBAL initial_A
VAR GLOBAL initial_B
VAR GLOBAL initial_C
VAR GLOBAL initial_D
VAR GLOBAL initial_E
VAR GLOBAL initial_CTX
VAR GLOBAL initial_SP
VAR GLOBAL initial_PC
VAR GLOBAL initial_GAS
VAR GLOBAL initial_SR
VAR GLOBAL initial_RR
VAR GLOBAL initial_HASHPOS
VAR GLOBAL initial_RCX

start:

       STEP => A
       0 :ASSERT


       A           :MSTORE(initial_A)
       B           :MSTORE(initial_B)
       C           :MSTORE(initial_C)
       D           :MSTORE(initial_D)
       E           :MSTORE(initial_E)
       CTX         :MSTORE(initial_CTX)
       SP          :MSTORE(initial_SP)
       PC          :MSTORE(initial_PC)
       GAS         :MSTORE(initial_GAS)
       SR          :MSTORE(initial_SR)
       RR          :MSTORE(initial_RR)
       HASHPOS     :MSTORE(initial_HASHPOS)
       RCX         :MSTORE(initial_RCX)
       0 => A,B,C,D,E,CTX, SP, PC, GAS, SR, RR, HASHPOS, RCX

       -1          :MSTORE(lastHashKId)
       -1          :MSTORE(lastHashPId)

        13640254227245024655838601068231183157721360561601028708811475275217122101072n          :MSTORE(finalExpBN254_f11_x)
        19308417300657558492615098636528930118171456086181403615599560648373004008445n          :MSTORE(finalExpBN254_f11_y)
        11600807028088028070223911119334614254604789223029238428546002219857166268982n          :MSTORE(finalExpBN254_f12_x)
        4879406373235938927297467572708988980645988929154072556290202741257062565094n           :MSTORE(finalExpBN254_f12_y)
        4171685090913488783052266386653991584736187693807813444268445186114207424938n           :MSTORE(finalExpBN254_f13_x)
        1277573873092817905392452044933753278511826457458184982228668801202320403016n           :MSTORE(finalExpBN254_f13_y)
        14431703268682647902296102635071887590346322924866425403256046961671041030534n          :MSTORE(finalExpBN254_f21_x)
        11898392435919290118390574221795784387718317590754683868792519816848089304255n          :MSTORE(finalExpBN254_f21_y)
        583787015380908422861158991038392109634638768690762169717364137330743074526n            :MSTORE(finalExpBN254_f22_x)
        13126870183170761631152540488140870675640427576483291663794972909787720839738n          :MSTORE(finalExpBN254_f22_y)
        6457767870676104874999362178075129079810053093666926870765167604207462152679n           :MSTORE(finalExpBN254_f23_x)
        12911511138445339632082563502636262379527290965988664015632615336010308825090n          :MSTORE(finalExpBN254_f23_y)
                                                                                                :CALL(finalExpBN254)
        13413524510323321318921703539856938196252165859353070108808910520379565591578n          :MLOAD(finalExpBN254_f11_x)
        3548381829456735642031500506306367847474828769923557674325753657986253436214n           :MLOAD(finalExpBN254_f11_y)
        11258588180307399598255242775094467208478122055367286369273756816466078325984n          :MLOAD(finalExpBN254_f12_x)
        15692415863664227683780306499051704744181486071132299317385971936570963983778n          :MLOAD(finalExpBN254_f12_y)
        14331327121685823241734822812072572580994818894715351943735993854561590776973n          :MLOAD(finalExpBN254_f13_x)
        5829057651356763815288519037751619402051833008237861839412688801032331829766n           :MLOAD(finalExpBN254_f13_y)
        15475783993587934296880977452723101772140252350911606731569729596277613550216n          :MLOAD(finalExpBN254_f21_x)
        5097655688415311910623889733978393264040884000272175630800968927057028195666n           :MLOAD(finalExpBN254_f21_y)
        11451831001542370722617744987566735321553462342240810632153337322850540201855n          :MLOAD(finalExpBN254_f22_x)
        10214880648406402761779167726229820911960967566000435639888288131094179536430n          :MLOAD(finalExpBN254_f22_y)
        7513746461017094458199399930075345786758663515755635567834665490471393582925n           :MLOAD(finalExpBN254_f23_x)
        1522857835029638585907442329762418957365351568194442821861575097484378991036n           :MLOAD(finalExpBN254_f23_y)

        4373180471897776675258309160655258716100668532239505928726075560119356030002n           :MSTORE(finalExpBN254_f11_x)
        1998330412639707119754272620557145281813809980883950342297299979818528684154n           :MSTORE(finalExpBN254_f11_y)
        18195156481784673240556983853217723353001088667319253095299836175016081692653n          :MSTORE(finalExpBN254_f12_x)
        14416987383147396072613358222719907151645356863831412780374841605584347181537n          :MSTORE(finalExpBN254_f12_y)
        13043331860922794250757689689044292794537063013289447519953992786299144640874n          :MSTORE(finalExpBN254_f13_x)
        7998822704208929271799060800163633892021893672636774922339957381963568184335n           :MSTORE(finalExpBN254_f13_y)
        11564170995253420243784236706220624235099028698811197560562608812904781569191n          :MSTORE(finalExpBN254_f21_x)
        1561438582167048283732233548379207606975476164189711297629851900955098634579n           :MSTORE(finalExpBN254_f21_y)
        6484979918970421531511710931913244277708494585657747727616767368177583870776n           :MSTORE(finalExpBN254_f22_x)
        20613445875497535013958846315705228024956718707377978402415068145098513246407n          :MSTORE(finalExpBN254_f22_y)
        138756767609839831937683255878181558527811811124453617774821196364866975362n            :MSTORE(finalExpBN254_f23_x)
        5664414496761134021650100592655664221381485706767860975330303186756080468547n           :MSTORE(finalExpBN254_f23_y)
                                                                                                :CALL(finalExpBN254)
        18376152097488863729411754051002103954297284193588700440955892969876269290212n          :MLOAD(finalExpBN254_f11_x)
        10621257193499535812872442420676526729712802633301668776844575825415515291706n          :MLOAD(finalExpBN254_f11_y)
        11633078801153629554817133551522435385231811573807701446913787691251259184784n          :MLOAD(finalExpBN254_f12_x)
        1524260132424840981642464422216152736107774714882905588040921992015558050028n           :MLOAD(finalExpBN254_f12_y)
        13420343631615804954746818284034553623986657939762003801605066035093420196426n          :MLOAD(finalExpBN254_f13_x)
        21248541410826964104409380037646359020348991574668385986534894680205665925043n          :MLOAD(finalExpBN254_f13_y)
        13187461668389015891472392065037907074391392568299301132940823459451095075224n          :MLOAD(finalExpBN254_f21_x)
        370549011265327086992512937475900461760428010118224584269772725798245423758n            :MLOAD(finalExpBN254_f21_y)
        12875992352119091280660051743521771761736469064351008729755940102932502650777n          :MLOAD(finalExpBN254_f22_x)
        1659574700423039326204581620794343904398710545559593831226184365695657415833n           :MLOAD(finalExpBN254_f22_y)
        12640187982786243062057108990058966774416170992161923454444647865801963113293n          :MLOAD(finalExpBN254_f23_x)
        5859898564016854141716025149318506863354930253919386641282498067410796710392n           :MLOAD(finalExpBN254_f23_y)

end:

        $ => A           :MLOAD(initial_A)
        $ => B           :MLOAD(initial_B)
        $ => C           :MLOAD(initial_C)
        $ => D           :MLOAD(initial_D)
        $ => E           :MLOAD(initial_E)
        $ => CTX         :MLOAD(initial_CTX)
        $ => SP          :MLOAD(initial_SP)
        $ => PC          :MLOAD(initial_PC)
        $ => GAS         :MLOAD(initial_GAS)
        $ => SR          :MLOAD(initial_SR)
        $ => RR          :MLOAD(initial_RR)
        $ => HASHPOS     :MLOAD(initial_HASHPOS)
        $ => RCX         :MLOAD(initial_RCX)

; label finalizeExecution needed by executor C++
finalizeExecution:
        ${beforeLast()}  : JMPN(finalizeExecution)

                         : JMP(start)
opINVALID:
; label checkAndSaveFrom needed by executor C++
checkAndSaveFrom:
                         :JMP(opINVALID)

INCLUDE "../main/pairings/constants.zkasm"

INCLUDE "../main/pairings/finalExpBN254.zkasm"

INCLUDE "../main/pairings/FPBN254/reduceFpBN254.zkasm"
INCLUDE "../main/pairings/FPBN254/addFpBN254.zkasm"

INCLUDE "../main/pairings/FP2BN254/addFp2BN254.zkasm"
INCLUDE "../main/pairings/FP2BN254/subFp2BN254.zkasm"
INCLUDE "../main/pairings/FP2BN254/mulFp2BN254.zkasm"
INCLUDE "../main/pairings/FP2BN254/squareFp2BN254.zkasm"
INCLUDE "../main/pairings/FP2BN254/scalarMulFp2BN254.zkasm"
INCLUDE "../main/pairings/FP2BN254/invFp2BN254.zkasm"

INCLUDE "../main/pairings/FP4BN254/squareFp4BN254.zkasm"

INCLUDE "../main/pairings/FP6BN254/addFp6BN254.zkasm"
INCLUDE "../main/pairings/FP6BN254/subFp6BN254.zkasm"
INCLUDE "../main/pairings/FP6BN254/mulFp6BN254.zkasm"
INCLUDE "../main/pairings/FP6BN254/sparseMulAFp6BN254.zkasm"
INCLUDE "../main/pairings/FP6BN254/squareFp6BN254.zkasm"
INCLUDE "../main/pairings/FP6BN254/inverseFp6BN254.zkasm"

INCLUDE "../main/pairings/FP12BN254/mulFp12BN254.zkasm"
INCLUDE "../main/pairings/FP12BN254/inverseFp12BN254.zkasm"
INCLUDE "../main/pairings/FP12BN254/frobFp12BN254.zkasm"
INCLUDE "../main/pairings/FP12BN254/frob2Fp12BN254.zkasm"
INCLUDE "../main/pairings/FP12BN254/frob3Fp12BN254.zkasm"

INCLUDE "../main/pairings/FP12BN254/CYCLOFP12BN254/xBinDecompBN254.zkasm"
INCLUDE "../main/pairings/FP12BN254/CYCLOFP12BN254/compressFp12BN254.zkasm"
INCLUDE "../main/pairings/FP12BN254/CYCLOFP12BN254/decompressFp12BN254.zkasm"
INCLUDE "../main/pairings/FP12BN254/CYCLOFP12BN254/squareCompCycloFp12BN254.zkasm"
INCLUDE "../main/pairings/FP12BN254/CYCLOFP12BN254/squareCycloFp12BN254.zkasm"
INCLUDE "../main/pairings/FP12BN254/CYCLOFP12BN254/expByXCompCycloFp12BN254.zkasm"