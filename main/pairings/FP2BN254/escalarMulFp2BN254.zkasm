;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;
;; escalarMulFp2BN254:
;;             in: A, (C + D·u)
;;             out: E = A·C (mod BN254_P)
;;                  C = A·D (mod BN254_P)
;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

VAR GLOBAL escalarMulFp2_tmp

; TODO: This is not sound, but correct
escalarMulFp2BN254:
        ${fpBN254mul(A,C)} => E
        ${fpBN254mul(A,D)}              :MSTORE(escalarMulFp2_tmp)
        
        $ => C                          :MLOAD(escalarMulFp2_tmp),RETURN