;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;
;; mulFp2BN254:
;;             E = A路B - C路D (mod BN254_P)
;;             C = A路D + B路C (mod BN254_P)
;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

VAR GLOBAL mulFp2_tmp

; TODO: This is not sound, but correct
mulFp2BN254:
        ${fp2Mul_x(A,B,C,D)} => E
        ${fp2Mul_y(A,B,C,D)}       :MSTORE(mulFp2_tmp),ARITH_FP_CMUL
        
        $ => C                           :MLOAD(mulFp2_tmp),RETURN