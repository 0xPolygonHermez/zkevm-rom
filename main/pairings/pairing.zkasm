;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;
;; Optimal Ate Pairing e: G1 x G2 -> GT over the BN254 curve
;; where G1 = E(Fp)[r] = E(Fp), G2 = E'(Fp2)[r] and GT = mu_r (the r-th roots of unity over (Fp12)^*)
;; the involved curves are E/Fp: y² = x³ + 3 and E'/Fp2: y² = x³ + 3/(9+u)
;;          input: P in G1 and Q in G2
;;          output: e(P,Q) in GT
;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

VAR GLOBAL pairing_P_x
VAR GLOBAL pairing_P_x3 
VAR GLOBAL pairing_P_y
VAR GLOBAL pairing_Q_x1
VAR GLOBAL pairing_Q_x2
VAR GLOBAL pairing_Q_y1
VAR GLOBAL pairing_Q_y2

VAR GLOBAL pairing_Frobenius1_Q_x1
VAR GLOBAL pairing_Frobenius1_Q_x2
VAR GLOBAL pairing_Frobenius1_Q_y1
VAR GLOBAL pairing_Frobenius1_Q_y2
VAR GLOBAL pairing_nFrobenius2_Q_x1
VAR GLOBAL pairing_nFrobenius2_Q_x2

VAR GLOBAL pairing_R_x1
VAR GLOBAL pairing_R_x2
VAR GLOBAL pairing_R_y1
VAR GLOBAL pairing_R_y2
VAR GLOBAL pairing_f11_x
VAR GLOBAL pairing_f11_y
VAR GLOBAL pairing_f12_x
VAR GLOBAL pairing_f12_y
VAR GLOBAL pairing_f13_x
VAR GLOBAL pairing_f13_y
VAR GLOBAL pairing_f21_x
VAR GLOBAL pairing_f21_y
VAR GLOBAL pairing_f22_x
VAR GLOBAL pairing_f22_y
VAR GLOBAL pairing_f23_x
VAR GLOBAL pairing_f23_y
VAR GLOBAL pairing_fsquare11_x
VAR GLOBAL pairing_fsquare11_y
VAR GLOBAL pairing_fsquare12_x
VAR GLOBAL pairing_fsquare12_y
VAR GLOBAL pairing_fsquare13_x
VAR GLOBAL pairing_fsquare13_y
VAR GLOBAL pairing_fsquare21_x
VAR GLOBAL pairing_fsquare21_y
VAR GLOBAL pairing_fsquare22_x
VAR GLOBAL pairing_fsquare22_y
VAR GLOBAL pairing_fsquare23_x
VAR GLOBAL pairing_fsquare23_y

VAR GLOBAL pairing_mx11_x
VAR GLOBAL pairing_mx11_y
VAR GLOBAL pairing_mx12_x
VAR GLOBAL pairing_mx12_y
VAR GLOBAL pairing_mx13_x
VAR GLOBAL pairing_mx13_y
VAR GLOBAL pairing_mx21_x
VAR GLOBAL pairing_mx21_y
VAR GLOBAL pairing_mx22_x
VAR GLOBAL pairing_mx22_y
VAR GLOBAL pairing_mx23_x
VAR GLOBAL pairing_mx23_y
VAR GLOBAL pairing_mxx11_x
VAR GLOBAL pairing_mxx11_y
VAR GLOBAL pairing_mxx12_x
VAR GLOBAL pairing_mxx12_y
VAR GLOBAL pairing_mxx13_x
VAR GLOBAL pairing_mxx13_y
VAR GLOBAL pairing_mxx21_x
VAR GLOBAL pairing_mxx21_y
VAR GLOBAL pairing_mxx22_x
VAR GLOBAL pairing_mxx22_y
VAR GLOBAL pairing_mxx23_x
VAR GLOBAL pairing_mxx23_y
VAR GLOBAL pairing_mxxx11_x
VAR GLOBAL pairing_mxxx11_y
VAR GLOBAL pairing_mxxx12_x
VAR GLOBAL pairing_mxxx12_y
VAR GLOBAL pairing_mxxx13_x
VAR GLOBAL pairing_mxxx13_y
VAR GLOBAL pairing_mxxx21_x
VAR GLOBAL pairing_mxxx21_y
VAR GLOBAL pairing_mxxx22_x
VAR GLOBAL pairing_mxxx22_y
VAR GLOBAL pairing_mxxx23_x
VAR GLOBAL pairing_mxxx23_y
VAR GLOBAL pairing_mp11_x
VAR GLOBAL pairing_mp11_y
VAR GLOBAL pairing_mp12_x
VAR GLOBAL pairing_mp12_y
VAR GLOBAL pairing_mp13_x
VAR GLOBAL pairing_mp13_y
VAR GLOBAL pairing_mp21_x
VAR GLOBAL pairing_mp21_y
VAR GLOBAL pairing_mp22_x
VAR GLOBAL pairing_mp22_y
VAR GLOBAL pairing_mp23_x
VAR GLOBAL pairing_mp23_y
VAR GLOBAL pairing_mpp11_x
VAR GLOBAL pairing_mpp11_y
VAR GLOBAL pairing_mpp12_x
VAR GLOBAL pairing_mpp12_y
VAR GLOBAL pairing_mpp13_x
VAR GLOBAL pairing_mpp13_y
VAR GLOBAL pairing_mpp21_x
VAR GLOBAL pairing_mpp21_y
VAR GLOBAL pairing_mpp22_x
VAR GLOBAL pairing_mpp22_y
VAR GLOBAL pairing_mpp23_x
VAR GLOBAL pairing_mpp23_y
VAR GLOBAL pairing_mppp11_x
VAR GLOBAL pairing_mppp11_y
VAR GLOBAL pairing_mppp12_x
VAR GLOBAL pairing_mppp12_y
VAR GLOBAL pairing_mppp13_x
VAR GLOBAL pairing_mppp13_y
VAR GLOBAL pairing_mppp21_x
VAR GLOBAL pairing_mppp21_y
VAR GLOBAL pairing_mppp22_x
VAR GLOBAL pairing_mppp22_y
VAR GLOBAL pairing_mppp23_x
VAR GLOBAL pairing_mppp23_y
VAR GLOBAL pairing_mxp11_x
VAR GLOBAL pairing_mxp11_y
VAR GLOBAL pairing_mxp12_x
VAR GLOBAL pairing_mxp12_y
VAR GLOBAL pairing_mxp13_x
VAR GLOBAL pairing_mxp13_y
VAR GLOBAL pairing_mxp21_x
VAR GLOBAL pairing_mxp21_y
VAR GLOBAL pairing_mxp22_x
VAR GLOBAL pairing_mxp22_y
VAR GLOBAL pairing_mxp23_x
VAR GLOBAL pairing_mxp23_y
VAR GLOBAL pairing_mxxp11_x
VAR GLOBAL pairing_mxxp11_y
VAR GLOBAL pairing_mxxp12_x
VAR GLOBAL pairing_mxxp12_y
VAR GLOBAL pairing_mxxp13_x
VAR GLOBAL pairing_mxxp13_y
VAR GLOBAL pairing_mxxp21_x
VAR GLOBAL pairing_mxxp21_y
VAR GLOBAL pairing_mxxp22_x
VAR GLOBAL pairing_mxxp22_y
VAR GLOBAL pairing_mxxp23_x
VAR GLOBAL pairing_mxxp23_y
VAR GLOBAL pairing_mxxxp11_x
VAR GLOBAL pairing_mxxxp11_y
VAR GLOBAL pairing_mxxxp12_x
VAR GLOBAL pairing_mxxxp12_y
VAR GLOBAL pairing_mxxxp13_x
VAR GLOBAL pairing_mxxxp13_y
VAR GLOBAL pairing_mxxxp21_x
VAR GLOBAL pairing_mxxxp21_y
VAR GLOBAL pairing_mxxxp22_x
VAR GLOBAL pairing_mxxxp22_y
VAR GLOBAL pairing_mxxxp23_x
VAR GLOBAL pairing_mxxxp23_y
VAR GLOBAL pairing_mxxpp11_x
VAR GLOBAL pairing_mxxpp11_y
VAR GLOBAL pairing_mxxpp12_x
VAR GLOBAL pairing_mxxpp12_y
VAR GLOBAL pairing_mxxpp13_x
VAR GLOBAL pairing_mxxpp13_y
VAR GLOBAL pairing_mxxpp21_x
VAR GLOBAL pairing_mxxpp21_y
VAR GLOBAL pairing_mxxpp22_x
VAR GLOBAL pairing_mxxpp22_y
VAR GLOBAL pairing_mxxpp23_x
VAR GLOBAL pairing_mxxpp23_y

VAR GLOBAL pairing_y1_11_x
VAR GLOBAL pairing_y1_11_y
VAR GLOBAL pairing_y1_12_x
VAR GLOBAL pairing_y1_12_y
VAR GLOBAL pairing_y1_13_x
VAR GLOBAL pairing_y1_13_y
VAR GLOBAL pairing_y1_21_x
VAR GLOBAL pairing_y1_21_y
VAR GLOBAL pairing_y1_22_x
VAR GLOBAL pairing_y1_22_y
VAR GLOBAL pairing_y1_23_x
VAR GLOBAL pairing_y1_23_y
VAR GLOBAL pairing_y2_11_x
VAR GLOBAL pairing_y2_11_y
VAR GLOBAL pairing_y2_12_x
VAR GLOBAL pairing_y2_12_y
VAR GLOBAL pairing_y2_13_x
VAR GLOBAL pairing_y2_13_y
VAR GLOBAL pairing_y2_21_x
VAR GLOBAL pairing_y2_21_y
VAR GLOBAL pairing_y2_22_x
VAR GLOBAL pairing_y2_22_y
VAR GLOBAL pairing_y2_23_x
VAR GLOBAL pairing_y2_23_y

VAR GLOBAL pairing_y4_11_x
VAR GLOBAL pairing_y4_11_y
VAR GLOBAL pairing_y4_12_x
VAR GLOBAL pairing_y4_12_y
VAR GLOBAL pairing_y4_13_x
VAR GLOBAL pairing_y4_13_y
VAR GLOBAL pairing_y4_21_x
VAR GLOBAL pairing_y4_21_y
VAR GLOBAL pairing_y4_22_x
VAR GLOBAL pairing_y4_22_y
VAR GLOBAL pairing_y4_23_x
VAR GLOBAL pairing_y4_23_y
VAR GLOBAL pairing_y5_11_x
VAR GLOBAL pairing_y5_11_y
VAR GLOBAL pairing_y5_12_x
VAR GLOBAL pairing_y5_12_y
VAR GLOBAL pairing_y5_13_x
VAR GLOBAL pairing_y5_13_y
VAR GLOBAL pairing_y5_21_x
VAR GLOBAL pairing_y5_21_y
VAR GLOBAL pairing_y5_22_x
VAR GLOBAL pairing_y5_22_y
VAR GLOBAL pairing_y5_23_x
VAR GLOBAL pairing_y5_23_y
VAR GLOBAL pairing_y6_11_x
VAR GLOBAL pairing_y6_11_y
VAR GLOBAL pairing_y6_12_x
VAR GLOBAL pairing_y6_12_y
VAR GLOBAL pairing_y6_13_x
VAR GLOBAL pairing_y6_13_y
VAR GLOBAL pairing_y6_21_x
VAR GLOBAL pairing_y6_21_y
VAR GLOBAL pairing_y6_22_x
VAR GLOBAL pairing_y6_22_y
VAR GLOBAL pairing_y6_23_x
VAR GLOBAL pairing_y6_23_y
VAR GLOBAL pairing_y7_11_x
VAR GLOBAL pairing_y7_11_y
VAR GLOBAL pairing_y7_12_x
VAR GLOBAL pairing_y7_12_y
VAR GLOBAL pairing_y7_13_x
VAR GLOBAL pairing_y7_13_y
VAR GLOBAL pairing_y7_21_x
VAR GLOBAL pairing_y7_21_y
VAR GLOBAL pairing_y7_22_x
VAR GLOBAL pairing_y7_22_y
VAR GLOBAL pairing_y7_23_x
VAR GLOBAL pairing_y7_23_y

VAR GLOBAL pairing_T11_11_x
VAR GLOBAL pairing_T11_11_y
VAR GLOBAL pairing_T11_12_x
VAR GLOBAL pairing_T11_12_y
VAR GLOBAL pairing_T11_13_x
VAR GLOBAL pairing_T11_13_y
VAR GLOBAL pairing_T11_21_x
VAR GLOBAL pairing_T11_21_y
VAR GLOBAL pairing_T11_22_x
VAR GLOBAL pairing_T11_22_y
VAR GLOBAL pairing_T11_23_x
VAR GLOBAL pairing_T11_23_y
VAR GLOBAL pairing_T21_11_x
VAR GLOBAL pairing_T21_11_y
VAR GLOBAL pairing_T21_12_x
VAR GLOBAL pairing_T21_12_y
VAR GLOBAL pairing_T21_13_x
VAR GLOBAL pairing_T21_13_y
VAR GLOBAL pairing_T21_21_x
VAR GLOBAL pairing_T21_21_y
VAR GLOBAL pairing_T21_22_x
VAR GLOBAL pairing_T21_22_y
VAR GLOBAL pairing_T21_23_x
VAR GLOBAL pairing_T21_23_y
VAR GLOBAL pairing_T12_11_x
VAR GLOBAL pairing_T12_11_y
VAR GLOBAL pairing_T12_12_x
VAR GLOBAL pairing_T12_12_y
VAR GLOBAL pairing_T12_13_x
VAR GLOBAL pairing_T12_13_y
VAR GLOBAL pairing_T12_21_x
VAR GLOBAL pairing_T12_21_y
VAR GLOBAL pairing_T12_22_x
VAR GLOBAL pairing_T12_22_y
VAR GLOBAL pairing_T12_23_x
VAR GLOBAL pairing_T12_23_y
VAR GLOBAL pairing_T23_11_x
VAR GLOBAL pairing_T23_11_y
VAR GLOBAL pairing_T23_12_x
VAR GLOBAL pairing_T23_12_y
VAR GLOBAL pairing_T23_13_x
VAR GLOBAL pairing_T23_13_y
VAR GLOBAL pairing_T23_21_x
VAR GLOBAL pairing_T23_21_y
VAR GLOBAL pairing_T23_22_x
VAR GLOBAL pairing_T23_22_y
VAR GLOBAL pairing_T23_23_x
VAR GLOBAL pairing_T23_23_y
VAR GLOBAL pairing_T24_11_x
VAR GLOBAL pairing_T24_11_y
VAR GLOBAL pairing_T24_12_x
VAR GLOBAL pairing_T24_12_y
VAR GLOBAL pairing_T24_13_x
VAR GLOBAL pairing_T24_13_y
VAR GLOBAL pairing_T24_21_x
VAR GLOBAL pairing_T24_21_y
VAR GLOBAL pairing_T24_22_x
VAR GLOBAL pairing_T24_22_y
VAR GLOBAL pairing_T24_23_x
VAR GLOBAL pairing_T24_23_y

VAR GLOBAL pairing_RR

VAR GLOBAL psi_x1
VAR GLOBAL psi_x2
VAR GLOBAL psi_y1
VAR GLOBAL psi_y2 

INCLUDE "constants.zkasm"

; ERROR CODES (B)
; 0 - no error
; 1 - P is not in G1
; 2 - Q is not in G2

; TODO: I think I should check that Px,Py,Qx1,Qx2,Qy1,Qy2 are field elements before anything else, otherwise do the modulo 

pairing:
    RR          :MSTORE(pairing_RR)

    ; Check if P = 0
    ${Fp2BN254neq0(mem.pairing_P_x) || Fp2BN254neq0(mem.pairing_P_y)}   :JMPZ(pairing_P_is_zero)

    ; Check if Q = 0
    ${Fp2BN254neq0(mem.pairing_Q_x1) || Fp2BN254neq0(mem.pairing_Q_x2) || Fp2BN254neq0(mem.pairing_Q_y1) || Fp2BN254neq0(mem.pairing_Q_y2)}   :JMPZ(pairing_Q_is_zero)

                :JMP(pairing_P_subgroup_check)


pairing_P_is_zero:
    ; Check that P is zero
    0n => B
    $ => A  :MLOAD(pairing_P_x)
    1       :EQ
    $ => A  :MLOAD(pairing_P_y)
    1       :EQ

    ; Check that Q is in G2
    ; Q in G2 iff psi(Q) == [6x²]Q as proven in Proposition 3 of 2022/352
    ; 1] Compute psi(Q)                   
    %BN254_P => A
    $ => B      :MLOAD(pairing_Q_x2)             
    $ => D      :SUB                                ; D = -Qx2
    %FROBENIUS_GAMMA121 => A
    %FROBENIUS_GAMMA122 => B
    $ => C      :MLOAD(pairing_Q_x1),CALL(mulFp2BN254)
    E           :MSTORE(psi_x1)
    C           :MSTORE(psi_x2)

    %BN254_P => A
    $ => B      :MLOAD(pairing_Q_y2)             
    $ => D      :SUB                                ; D = -Qx2
    %FROBENIUS_GAMMA131 => A
    %FROBENIUS_GAMMA132 => B
    $ => C      :MLOAD(pairing_Q_y1),CALL(mulFp2BN254)
    E           :MSTORE(psi_y1)
    C           :MSTORE(psi_y2)

    ; 2] Compute [6x²]Q
    $ => A      :MLOAD(pairing_Q_x1)
    $ => B      :MLOAD(pairing_Q_x2)
    $ => C      :MLOAD(pairing_Q_y1)
    $ => D      :MLOAD(pairing_Q_y2)
    A           :MSTORE(escalarMulBN254_P_x1)
    B           :MSTORE(escalarMulBN254_P_x2)
    C           :MSTORE(escalarMulBN254_P_y1)
    D           :MSTORE(escalarMulBN254_P_y2)
    147946756881789318990833708069417712966n :MSTORE(escalarMulBN254_k) ; 6x²
                :CALL(escalarMulBN254)


    ; 3] Check if psi(Q) == [6x²]Q
    $ => A      :MLOAD(psi_x1)
    $ => B      :MLOAD(escalarMulBN254_Q_x1)
    $           :EQ,JMPNC(pairing_Q_is_not_in_G2)

    $ => A      :MLOAD(psi_x2)
    $ => B      :MLOAD(escalarMulBN254_Q_x2)
    $           :EQ,JMPNC(pairing_Q_is_not_in_G2)

    $ => A      :MLOAD(psi_y1)
    $ => B      :MLOAD(escalarMulBN254_Q_y1)
    $           :EQ,JMPNC(pairing_Q_is_not_in_G2)

    $ => A      :MLOAD(psi_y2)
    $ => B      :MLOAD(escalarMulBN254_Q_y2)
    $           :EQ,JMPNC(pairing_Q_is_not_in_G2)


    1n      :MSTORE(pairing_f11_x)
    0n      :MSTORE(pairing_f11_y)
    0n      :MSTORE(pairing_f12_x)
    0n      :MSTORE(pairing_f12_y)
    0n      :MSTORE(pairing_f13_x)
    0n      :MSTORE(pairing_f13_y)
    0n      :MSTORE(pairing_f21_x)
    0n      :MSTORE(pairing_f21_y)
    0n      :MSTORE(pairing_f22_x)
    0n      :MSTORE(pairing_f22_y)
    0n      :MSTORE(pairing_f23_x)
    0n      :MSTORE(pairing_f23_y)

    0 => B     :JMP(pairing_end)

pairing_Q_is_zero:
    ; Check that Q is zero
    0n => B
    $ => A  :MLOAD(pairing_Q_x1)
    1       :EQ
    $ => A  :MLOAD(pairing_Q_x2)
    1       :EQ
    $ => A  :MLOAD(pairing_Q_y1)
    1       :EQ
    $ => A  :MLOAD(pairing_Q_y2)
    1       :EQ

    ; Check that P is in G1
    ; P in G1 iff (Py)² == (Px)³ + 3 (mod p)
    ; 1] Compute LHS and RHS
    $ => A,B    :MLOAD(pairing_P_x),CALL(mulFpBN254); C = (Px)²
    C => A                                         ; A = (Px)²
    $ => B      :MLOAD(pairing_P_x),CALL(mulFpBN254); C = (Px)³

    3n => A     :CALL(addFpBN254)                  ; C = (Px)³ + 3
    C           :MSTORE(pairing_P_x3)               ; pairing_P_x3 = (Px)³ + 3

    $ => A,B    :MLOAD(pairing_P_y),CALL(mulFpBN254); C = (Py)²

    ; 2] Check if LHS == RHS
    C => A
    $ => B      :MLOAD(pairing_P_x3) 
    $           :EQ,JMPNC(pairing_P_is_not_in_G1)

    1n      :MSTORE(pairing_f11_x)
    0n      :MSTORE(pairing_f11_y)
    0n      :MSTORE(pairing_f12_x)
    0n      :MSTORE(pairing_f12_y)
    0n      :MSTORE(pairing_f13_x)
    0n      :MSTORE(pairing_f13_y)
    0n      :MSTORE(pairing_f21_x)
    0n      :MSTORE(pairing_f21_y)
    0n      :MSTORE(pairing_f22_x)
    0n      :MSTORE(pairing_f22_y)
    0n      :MSTORE(pairing_f23_x)
    0n      :MSTORE(pairing_f23_y)

    0 => B     :JMP(pairing_end)

pairing_P_subgroup_check:
    ; P in G1 iff (Py)² == (Px)³ + 3 (mod p)
    ; 1] Compute LHS and RHS
    $ => A,B    :MLOAD(pairing_P_x),CALL(mulFpBN254); C = (Px)²
    C => A                                         ; A = (Px)²
    $ => B      :MLOAD(pairing_P_x),CALL(mulFpBN254); C = (Px)³

    3n => A     :CALL(addFpBN254)                  ; C = (Px)³ + 3
    C           :MSTORE(pairing_P_x3)               ; pairing_P_x3 = (Px)³ + 3

    $ => A,B    :MLOAD(pairing_P_y),CALL(mulFpBN254); C = (Py)²

    ; 2] Check if LHS == RHS
    C => A
    $ => B      :MLOAD(pairing_P_x3) 
    $           :EQ,JMPNC(pairing_P_is_not_in_G1)

pairing_Q_subgroup_check:
    ; Q in G2 iff psi(Q) == [6x²]Q as proven in Proposition 3 of 2022/352
    ; 1] Compute psi(Q)                   
    %BN254_P => A
    $ => B      :MLOAD(pairing_Q_x2)             
    $ => D      :SUB                                ; D = -Qx2
    %FROBENIUS_GAMMA121 => A
    %FROBENIUS_GAMMA122 => B
    $ => C      :MLOAD(pairing_Q_x1),CALL(mulFp2BN254)
    E           :MSTORE(psi_x1)
    C           :MSTORE(psi_x2)

    %BN254_P => A
    $ => B      :MLOAD(pairing_Q_y2)             
    $ => D      :SUB                                ; D = -Qx2
    %FROBENIUS_GAMMA131 => A
    %FROBENIUS_GAMMA132 => B
    $ => C      :MLOAD(pairing_Q_y1),CALL(mulFp2BN254)
    E           :MSTORE(psi_y1)
    C           :MSTORE(psi_y2)

    ; 2] Compute [6x²]Q
    $ => A      :MLOAD(pairing_Q_x1)
    $ => B      :MLOAD(pairing_Q_x2)
    $ => C      :MLOAD(pairing_Q_y1)
    $ => D      :MLOAD(pairing_Q_y2)
    A           :MSTORE(escalarMulBN254_P_x1)
    B           :MSTORE(escalarMulBN254_P_x2)
    C           :MSTORE(escalarMulBN254_P_y1)
    D           :MSTORE(escalarMulBN254_P_y2)
    147946756881789318990833708069417712966n :MSTORE(escalarMulBN254_k) ; 6x²
                :CALL(escalarMulBN254)


    ; 3] Check if psi(Q) == [6x²]Q
    $ => A      :MLOAD(psi_x1)
    $ => B      :MLOAD(escalarMulBN254_Q_x1)
    $           :EQ,JMPNC(pairing_Q_is_not_in_G2)

    $ => A      :MLOAD(psi_x2)
    $ => B      :MLOAD(escalarMulBN254_Q_x2)
    $           :EQ,JMPNC(pairing_Q_is_not_in_G2)

    $ => A      :MLOAD(psi_y1)
    $ => B      :MLOAD(escalarMulBN254_Q_y1)
    $           :EQ,JMPNC(pairing_Q_is_not_in_G2)

    $ => A      :MLOAD(psi_y2)
    $ => B      :MLOAD(escalarMulBN254_Q_y2)
    $           :EQ,JMPNC(pairing_Q_is_not_in_G2)

pairing_Miller_loop_init:
    65 => RCX

    ; Initiliaze Miller loop with R = Q and f = 1
    $ => A      :MLOAD(pairing_Q_x1)
    $ => B      :MLOAD(pairing_Q_x2)
    $ => C      :MLOAD(pairing_Q_y1)
    $ => D      :MLOAD(pairing_Q_y2)
    A           :MSTORE(pairing_R_x1)
    B           :MSTORE(pairing_R_x2)
    C           :MSTORE(pairing_R_y1)
    D           :MSTORE(pairing_R_y2)
    1n          :MSTORE(pairing_f11_x)

pairing_Miller_loop:
    RCX - 1 => RCX    :JMPZ(pairing_last_two_lines)

    ; TODO: The product f² and line_{twist(R),twist(R)}(P) can be optimized since second
    ;       has half of the cofficients equal to 0
    ; 1] f = f² · line_{twist(R),twist(R)}(P)

    ; f²
    $ => A      :MLOAD(pairing_f11_x)
    $ => B      :MLOAD(pairing_f11_y)
    A           :MSTORE(squareFp12BN254_a11_x)
    B           :MSTORE(squareFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_f12_x)
    $ => B      :MLOAD(pairing_f12_y)
    A           :MSTORE(squareFp12BN254_a12_x)
    B           :MSTORE(squareFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_f13_x)
    $ => B      :MLOAD(pairing_f13_y)
    A           :MSTORE(squareFp12BN254_a13_x)
    B           :MSTORE(squareFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_f21_x)
    $ => B      :MLOAD(pairing_f21_y)
    A           :MSTORE(squareFp12BN254_a21_x)
    B           :MSTORE(squareFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_f22_x)
    $ => B      :MLOAD(pairing_f22_y)
    A           :MSTORE(squareFp12BN254_a22_x)
    B           :MSTORE(squareFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_f23_x)
    $ => B      :MLOAD(pairing_f23_y)
    A           :MSTORE(squareFp12BN254_a23_x)
    B           :MSTORE(squareFp12BN254_a23_y)
                :CALL(squareFp12BN254)
    $ => A      :MLOAD(squareFp12BN254_c11_x)
    $ => B      :MLOAD(squareFp12BN254_c11_y)
    A           :MSTORE(pairing_fsquare11_x)
    B           :MSTORE(pairing_fsquare11_y)
    $ => A      :MLOAD(squareFp12BN254_c12_x)
    $ => B      :MLOAD(squareFp12BN254_c12_y)
    A           :MSTORE(pairing_fsquare12_x)
    B           :MSTORE(pairing_fsquare12_y)
    $ => A      :MLOAD(squareFp12BN254_c13_x)
    $ => B      :MLOAD(squareFp12BN254_c13_y)
    A           :MSTORE(pairing_fsquare13_x)
    B           :MSTORE(pairing_fsquare13_y)
    $ => A      :MLOAD(squareFp12BN254_c21_x)
    $ => B      :MLOAD(squareFp12BN254_c21_y)
    A           :MSTORE(pairing_fsquare21_x)
    B           :MSTORE(pairing_fsquare21_y)
    $ => A      :MLOAD(squareFp12BN254_c22_x)
    $ => B      :MLOAD(squareFp12BN254_c22_y)
    A           :MSTORE(pairing_fsquare22_x)
    B           :MSTORE(pairing_fsquare22_y)
    $ => A      :MLOAD(squareFp12BN254_c23_x)
    $ => B      :MLOAD(squareFp12BN254_c23_y)
    A           :MSTORE(pairing_fsquare23_x)
    B           :MSTORE(pairing_fsquare23_y)

    ; line_{twist(R),twist(R)}(P)
    $ => A      :MLOAD(pairing_R_x1)
    $ => B      :MLOAD(pairing_R_x2)
    $ => C      :MLOAD(pairing_R_y1)
    $ => D      :MLOAD(pairing_R_y2)
    A           :MSTORE(lineSamePointsBN254_P_x1)
    B           :MSTORE(lineSamePointsBN254_P_x2)
    C           :MSTORE(lineSamePointsBN254_P_y1)
    D           :MSTORE(lineSamePointsBN254_P_y2)
    $ => A      :MLOAD(pairing_P_x)
    $ => B      :MLOAD(pairing_P_y)
    A           :MSTORE(lineSamePointsBN254_Q_x)
    B           :MSTORE(lineSamePointsBN254_Q_y)
                :CALL(lineSamePointsBN254)
    $ => A      :MLOAD(pairing_fsquare11_x)
    $ => B      :MLOAD(pairing_fsquare11_y)
    A           :MSTORE(mulFp12BN254_a11_x)
    B           :MSTORE(mulFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_fsquare12_x)
    $ => B      :MLOAD(pairing_fsquare12_y)
    A           :MSTORE(mulFp12BN254_a12_x)
    B           :MSTORE(mulFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_fsquare13_x)
    $ => B      :MLOAD(pairing_fsquare13_y)
    A           :MSTORE(mulFp12BN254_a13_x)
    B           :MSTORE(mulFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_fsquare21_x)
    $ => B      :MLOAD(pairing_fsquare21_y)
    A           :MSTORE(mulFp12BN254_a21_x)
    B           :MSTORE(mulFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_fsquare22_x)
    $ => B      :MLOAD(pairing_fsquare22_y)
    A           :MSTORE(mulFp12BN254_a22_x)
    B           :MSTORE(mulFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_fsquare23_x)
    $ => B      :MLOAD(pairing_fsquare23_y)
    A           :MSTORE(mulFp12BN254_a23_x)
    B           :MSTORE(mulFp12BN254_a23_y)

    $ => A      :MLOAD(lineSamePointsBN254_l11_x)
    $ => B      :MLOAD(lineSamePointsBN254_l11_y)
    A           :MSTORE(mulFp12BN254_b11_x)
    B           :MSTORE(mulFp12BN254_b11_y)
    0n          :MSTORE(mulFp12BN254_b12_x)
    0n          :MSTORE(mulFp12BN254_b12_y)
    $ => A      :MLOAD(lineSamePointsBN254_l13_x)
    $ => B      :MLOAD(lineSamePointsBN254_l13_y)
    A           :MSTORE(mulFp12BN254_b13_x)
    B           :MSTORE(mulFp12BN254_b13_y)
    0n          :MSTORE(mulFp12BN254_b21_x)
    0n          :MSTORE(mulFp12BN254_b21_y)
    $ => A      :MLOAD(lineSamePointsBN254_l22_x)
    $ => B      :MLOAD(lineSamePointsBN254_l22_y)
    A           :MSTORE(mulFp12BN254_b22_x)
    B           :MSTORE(mulFp12BN254_b22_y)
    0n          :MSTORE(mulFp12BN254_b23_x)
    0n          :MSTORE(mulFp12BN254_b23_y)
                :CALL(mulFp12BN254)
    $ => A      :MLOAD(mulFp12BN254_c11_x)
    $ => B      :MLOAD(mulFp12BN254_c11_y)
    A           :MSTORE(pairing_f11_x)
    B           :MSTORE(pairing_f11_y)
    $ => A      :MLOAD(mulFp12BN254_c12_x)
    $ => B      :MLOAD(mulFp12BN254_c12_y)
    A           :MSTORE(pairing_f12_x)
    B           :MSTORE(pairing_f12_y)
    $ => A      :MLOAD(mulFp12BN254_c13_x)
    $ => B      :MLOAD(mulFp12BN254_c13_y)
    A           :MSTORE(pairing_f13_x)
    B           :MSTORE(pairing_f13_y)
    $ => A      :MLOAD(mulFp12BN254_c21_x)
    $ => B      :MLOAD(mulFp12BN254_c21_y)
    A           :MSTORE(pairing_f21_x)
    B           :MSTORE(pairing_f21_y)
    $ => A      :MLOAD(mulFp12BN254_c22_x)
    $ => B      :MLOAD(mulFp12BN254_c22_y)
    A           :MSTORE(pairing_f22_x)
    B           :MSTORE(pairing_f22_y)
    $ => A      :MLOAD(mulFp12BN254_c23_x)
    $ => B      :MLOAD(mulFp12BN254_c23_y)
    A           :MSTORE(pairing_f23_x)
    B           :MSTORE(pairing_f23_y)

    ; TODO: Should I create a file for point doubling?
    ; TODO: I think this can be optimized
    ; 2] R = 2·R 
    $ => A      :MLOAD(pairing_R_x1)
    $ => B      :MLOAD(pairing_R_x2)
    $ => C      :MLOAD(pairing_R_y1)
    $ => D      :MLOAD(pairing_R_y2)
    A           :MSTORE(addPointBN254_P1_x1)
    A           :MSTORE(addPointBN254_P2_x1)
    B           :MSTORE(addPointBN254_P1_x2)
    B           :MSTORE(addPointBN254_P2_x2)
    C           :MSTORE(addPointBN254_P1_y1)
    C           :MSTORE(addPointBN254_P2_y1)
    D           :MSTORE(addPointBN254_P1_y2)
    D           :MSTORE(addPointBN254_P2_y2)
                :CALL(addPointBN254)
    $ => A      :MLOAD(addPointBN254_P3_x1)
    $ => B      :MLOAD(addPointBN254_P3_x2)
    $ => C      :MLOAD(addPointBN254_P3_y1)
    $ => D      :MLOAD(addPointBN254_P3_y2)
    A           :MSTORE(pairing_R_x1)
    B           :MSTORE(pairing_R_x2)
    C           :MSTORE(pairing_R_y1)
    D           :MSTORE(pairing_R_y2)

    RCX-1 => RR
                :CALL(@loopLengthBN254 + RR)
    
    ; if bit = -1, then "sub"
    B           :JMPN(pairing_Miller_loop_sub)

    ; if bit = 0, then repeat
    B           :JMPZ(pairing_Miller_loop)

    ; else, "add"

pairing_Miller_loop_add:
    ; 1] f = f · line_{twist(R),twist(Q)}(P)
    $ => A      :MLOAD(pairing_R_x1)
    $ => B      :MLOAD(pairing_R_x2)
    $ => C      :MLOAD(pairing_R_y1)
    $ => D      :MLOAD(pairing_R_y2)
    A           :MSTORE(lineDiffPointsBN254_P1_x1)
    B           :MSTORE(lineDiffPointsBN254_P1_x2)
    C           :MSTORE(lineDiffPointsBN254_P1_y1)
    D           :MSTORE(lineDiffPointsBN254_P1_y2)
    $ => A      :MLOAD(pairing_Q_x1)
    $ => B      :MLOAD(pairing_Q_x2)
    $ => C      :MLOAD(pairing_Q_y1)
    $ => D      :MLOAD(pairing_Q_y2)
    A           :MSTORE(lineDiffPointsBN254_P2_x1)
    B           :MSTORE(lineDiffPointsBN254_P2_x2)
    C           :MSTORE(lineDiffPointsBN254_P2_y1)
    D           :MSTORE(lineDiffPointsBN254_P2_y2)
    $ => A      :MLOAD(pairing_P_x)
    $ => B      :MLOAD(pairing_P_y)
    A           :MSTORE(lineDiffPointsBN254_Q_x)
    B           :MSTORE(lineDiffPointsBN254_Q_y)
                :CALL(lineDiffPointsBN254)
    $ => A      :MLOAD(pairing_f11_x)
    $ => B      :MLOAD(pairing_f11_y)
    A           :MSTORE(mulFp12BN254_a11_x)
    B           :MSTORE(mulFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_f12_x)
    $ => B      :MLOAD(pairing_f12_y)
    A           :MSTORE(mulFp12BN254_a12_x)
    B           :MSTORE(mulFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_f13_x)
    $ => B      :MLOAD(pairing_f13_y)
    A           :MSTORE(mulFp12BN254_a13_x)
    B           :MSTORE(mulFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_f21_x)
    $ => B      :MLOAD(pairing_f21_y)
    A           :MSTORE(mulFp12BN254_a21_x)
    B           :MSTORE(mulFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_f22_x)
    $ => B      :MLOAD(pairing_f22_y)
    A           :MSTORE(mulFp12BN254_a22_x)
    B           :MSTORE(mulFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_f23_x)
    $ => B      :MLOAD(pairing_f23_y)
    A           :MSTORE(mulFp12BN254_a23_x)
    B           :MSTORE(mulFp12BN254_a23_y)

    0n          :MSTORE(mulFp12BN254_b11_x)
    0n          :MSTORE(mulFp12BN254_b11_y)
    $ => A      :MLOAD(lineDiffPointsBN254_l12_x)
    $ => B      :MLOAD(lineDiffPointsBN254_l12_y)
    A           :MSTORE(mulFp12BN254_b12_x)
    B           :MSTORE(mulFp12BN254_b12_y)
    0n          :MSTORE(mulFp12BN254_b13_x)
    0n          :MSTORE(mulFp12BN254_b13_y)
    0n          :MSTORE(mulFp12BN254_b21_x)
    0n          :MSTORE(mulFp12BN254_b21_y)
    $ => A      :MLOAD(lineDiffPointsBN254_l22_x)
    $ => B      :MLOAD(lineDiffPointsBN254_l22_y)
    A           :MSTORE(mulFp12BN254_b22_x)
    B           :MSTORE(mulFp12BN254_b22_y)
    $ => A      :MLOAD(lineDiffPointsBN254_l23_x)
    $ => B      :MLOAD(lineDiffPointsBN254_l23_y)
    A           :MSTORE(mulFp12BN254_b23_x)
    B           :MSTORE(mulFp12BN254_b23_y)
                :CALL(mulFp12BN254)
    $ => A      :MLOAD(mulFp12BN254_c11_x)
    $ => B      :MLOAD(mulFp12BN254_c11_y)
    A           :MSTORE(pairing_f11_x)
    B           :MSTORE(pairing_f11_y)
    $ => A      :MLOAD(mulFp12BN254_c12_x)
    $ => B      :MLOAD(mulFp12BN254_c12_y)
    A           :MSTORE(pairing_f12_x)
    B           :MSTORE(pairing_f12_y)
    $ => A      :MLOAD(mulFp12BN254_c13_x)
    $ => B      :MLOAD(mulFp12BN254_c13_y)
    A           :MSTORE(pairing_f13_x)
    B           :MSTORE(pairing_f13_y)
    $ => A      :MLOAD(mulFp12BN254_c21_x)
    $ => B      :MLOAD(mulFp12BN254_c21_y)
    A           :MSTORE(pairing_f21_x)
    B           :MSTORE(pairing_f21_y)
    $ => A      :MLOAD(mulFp12BN254_c22_x)
    $ => B      :MLOAD(mulFp12BN254_c22_y)
    A           :MSTORE(pairing_f22_x)
    B           :MSTORE(pairing_f22_y)
    $ => A      :MLOAD(mulFp12BN254_c23_x)
    $ => B      :MLOAD(mulFp12BN254_c23_y)
    A           :MSTORE(pairing_f23_x)
    B           :MSTORE(pairing_f23_y)

    ; 2] R = R + Q
    $ => A      :MLOAD(pairing_R_x1)
    $ => B      :MLOAD(pairing_R_x2)
    $ => C      :MLOAD(pairing_R_y1)
    $ => D      :MLOAD(pairing_R_y2)
    A           :MSTORE(addPointBN254_P1_x1)
    B           :MSTORE(addPointBN254_P1_x2)
    C           :MSTORE(addPointBN254_P1_y1)
    D           :MSTORE(addPointBN254_P1_y2)
    $ => A      :MLOAD(pairing_Q_x1)
    $ => B      :MLOAD(pairing_Q_x2)
    $ => C      :MLOAD(pairing_Q_y1)
    $ => D      :MLOAD(pairing_Q_y2)
    A           :MSTORE(addPointBN254_P2_x1)
    B           :MSTORE(addPointBN254_P2_x2)
    C           :MSTORE(addPointBN254_P2_y1)
    D           :MSTORE(addPointBN254_P2_y2)
                :CALL(addPointBN254)
    $ => A      :MLOAD(addPointBN254_P3_x1)
    $ => B      :MLOAD(addPointBN254_P3_x2)
    $ => C      :MLOAD(addPointBN254_P3_y1)
    $ => D      :MLOAD(addPointBN254_P3_y2)
    A           :MSTORE(pairing_R_x1)
    B           :MSTORE(pairing_R_x2)
    C           :MSTORE(pairing_R_y1)
    D           :MSTORE(pairing_R_y2)

                :JMP(pairing_Miller_loop)


pairing_Miller_loop_sub:
    ; 1] f = f · line_{twist(R),twist(-Q)}(P)
    $ => A      :MLOAD(pairing_R_x1)
    $ => B      :MLOAD(pairing_R_x2)
    $ => C      :MLOAD(pairing_R_y1)
    $ => D      :MLOAD(pairing_R_y2)
    A           :MSTORE(lineDiffPointsBN254_P1_x1)
    B           :MSTORE(lineDiffPointsBN254_P1_x2)
    C           :MSTORE(lineDiffPointsBN254_P1_y1)
    D           :MSTORE(lineDiffPointsBN254_P1_y2)
    $ => A      :MLOAD(pairing_Q_x1)
    $ => B      :MLOAD(pairing_Q_x2)
    $ => C      :MLOAD(pairing_Q_y1)
    $ => D      :MLOAD(pairing_Q_y2)
    A           :MSTORE(lineDiffPointsBN254_P2_x1)
    B           :MSTORE(lineDiffPointsBN254_P2_x2)
    ${const.BN254_P - C}           :MSTORE(lineDiffPointsBN254_P2_y1)
    ${const.BN254_P - D}           :MSTORE(lineDiffPointsBN254_P2_y2)

    $ => A      :MLOAD(pairing_P_x)
    $ => B      :MLOAD(pairing_P_y)
    A           :MSTORE(lineDiffPointsBN254_Q_x)
    B           :MSTORE(lineDiffPointsBN254_Q_y)
                :CALL(lineDiffPointsBN254)
    $ => A      :MLOAD(pairing_f11_x)
    $ => B      :MLOAD(pairing_f11_y)
    A           :MSTORE(mulFp12BN254_a11_x)
    B           :MSTORE(mulFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_f12_x)
    $ => B      :MLOAD(pairing_f12_y)
    A           :MSTORE(mulFp12BN254_a12_x)
    B           :MSTORE(mulFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_f13_x)
    $ => B      :MLOAD(pairing_f13_y)
    A           :MSTORE(mulFp12BN254_a13_x)
    B           :MSTORE(mulFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_f21_x)
    $ => B      :MLOAD(pairing_f21_y)
    A           :MSTORE(mulFp12BN254_a21_x)
    B           :MSTORE(mulFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_f22_x)
    $ => B      :MLOAD(pairing_f22_y)
    A           :MSTORE(mulFp12BN254_a22_x)
    B           :MSTORE(mulFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_f23_x)
    $ => B      :MLOAD(pairing_f23_y)
    A           :MSTORE(mulFp12BN254_a23_x)
    B           :MSTORE(mulFp12BN254_a23_y)

    0n          :MSTORE(mulFp12BN254_b11_x)
    0n          :MSTORE(mulFp12BN254_b11_y)
    $ => A      :MLOAD(lineDiffPointsBN254_l12_x)
    $ => B      :MLOAD(lineDiffPointsBN254_l12_y)
    A           :MSTORE(mulFp12BN254_b12_x)
    B           :MSTORE(mulFp12BN254_b12_y)
    0n          :MSTORE(mulFp12BN254_b13_x)
    0n          :MSTORE(mulFp12BN254_b13_y)
    0n          :MSTORE(mulFp12BN254_b21_x)
    0n          :MSTORE(mulFp12BN254_b21_y)
    $ => A      :MLOAD(lineDiffPointsBN254_l22_x)
    $ => B      :MLOAD(lineDiffPointsBN254_l22_y)
    A           :MSTORE(mulFp12BN254_b22_x)
    B           :MSTORE(mulFp12BN254_b22_y)
    $ => A      :MLOAD(lineDiffPointsBN254_l23_x)
    $ => B      :MLOAD(lineDiffPointsBN254_l23_y)
    A           :MSTORE(mulFp12BN254_b23_x)
    B           :MSTORE(mulFp12BN254_b23_y)
                :CALL(mulFp12BN254)
    $ => A      :MLOAD(mulFp12BN254_c11_x)
    $ => B      :MLOAD(mulFp12BN254_c11_y)
    A           :MSTORE(pairing_f11_x)
    B           :MSTORE(pairing_f11_y)
    $ => A      :MLOAD(mulFp12BN254_c12_x)
    $ => B      :MLOAD(mulFp12BN254_c12_y)
    A           :MSTORE(pairing_f12_x)
    B           :MSTORE(pairing_f12_y)
    $ => A      :MLOAD(mulFp12BN254_c13_x)
    $ => B      :MLOAD(mulFp12BN254_c13_y)
    A           :MSTORE(pairing_f13_x)
    B           :MSTORE(pairing_f13_y)
    $ => A      :MLOAD(mulFp12BN254_c21_x)
    $ => B      :MLOAD(mulFp12BN254_c21_y)
    A           :MSTORE(pairing_f21_x)
    B           :MSTORE(pairing_f21_y)
    $ => A      :MLOAD(mulFp12BN254_c22_x)
    $ => B      :MLOAD(mulFp12BN254_c22_y)
    A           :MSTORE(pairing_f22_x)
    B           :MSTORE(pairing_f22_y)
    $ => A      :MLOAD(mulFp12BN254_c23_x)
    $ => B      :MLOAD(mulFp12BN254_c23_y)
    A           :MSTORE(pairing_f23_x)
    B           :MSTORE(pairing_f23_y)

    ; 2] R = R - Q
    $ => A      :MLOAD(pairing_R_x1)
    $ => B      :MLOAD(pairing_R_x2)
    $ => C      :MLOAD(pairing_R_y1)
    $ => D      :MLOAD(pairing_R_y2)
    A           :MSTORE(addPointBN254_P1_x1)
    B           :MSTORE(addPointBN254_P1_x2)
    C           :MSTORE(addPointBN254_P1_y1)
    D           :MSTORE(addPointBN254_P1_y2)
    $ => A      :MLOAD(pairing_Q_x1)
    $ => B      :MLOAD(pairing_Q_x2)
    $ => C      :MLOAD(pairing_Q_y1)
    $ => D      :MLOAD(pairing_Q_y2)
    A           :MSTORE(addPointBN254_P2_x1)
    B           :MSTORE(addPointBN254_P2_x2)
    ; TODO: Use the SUB instruction
    ${const.BN254_P - C}           :MSTORE(addPointBN254_P2_y1)
    ${const.BN254_P - D}           :MSTORE(addPointBN254_P2_y2)
                :CALL(addPointBN254)
    $ => A      :MLOAD(addPointBN254_P3_x1)
    $ => B      :MLOAD(addPointBN254_P3_x2)
    $ => C      :MLOAD(addPointBN254_P3_y1)
    $ => D      :MLOAD(addPointBN254_P3_y2)
    A           :MSTORE(pairing_R_x1)
    B           :MSTORE(pairing_R_x2)
    C           :MSTORE(pairing_R_y1)
    D           :MSTORE(pairing_R_y2)

                :JMP(pairing_Miller_loop)

pairing_last_two_lines:
    ; 1] Given Q = (x,y) with x,y ∈ Fp2, compute Frobenius1(Q) = (\gamma12·x̄, \gamma13·ȳ)
    %FROBENIUS_GAMMA121 => A
    %FROBENIUS_GAMMA122 => B
    $ => C      :MLOAD(pairing_Q_x1)
    $ => D      :MLOAD(pairing_Q_x2)
    ${const.BN254_P - D} => D
                :CALL(mulFp2BN254)
    E           :MSTORE(pairing_Frobenius1_Q_x1)
    C           :MSTORE(pairing_Frobenius1_Q_x2)

    %FROBENIUS_GAMMA131 => A
    %FROBENIUS_GAMMA132 => B
    $ => C      :MLOAD(pairing_Q_y1)
    $ => D      :MLOAD(pairing_Q_y2)
    ${const.BN254_P - D} => D
                :CALL(mulFp2BN254)
    E           :MSTORE(pairing_Frobenius1_Q_y1)
    C           :MSTORE(pairing_Frobenius1_Q_y2)


    ; 2] f = f · line_{twist(R),twist(Frobenius1(Q))}(P)
    $ => A      :MLOAD(pairing_R_x1)
    $ => B      :MLOAD(pairing_R_x2)
    $ => C      :MLOAD(pairing_R_y1)
    $ => D      :MLOAD(pairing_R_y2)
    A           :MSTORE(lineDiffPointsBN254_P1_x1)
    B           :MSTORE(lineDiffPointsBN254_P1_x2)
    C           :MSTORE(lineDiffPointsBN254_P1_y1)
    D           :MSTORE(lineDiffPointsBN254_P1_y2)
    $ => A      :MLOAD(pairing_Frobenius1_Q_x1)
    $ => B      :MLOAD(pairing_Frobenius1_Q_x2)
    $ => C      :MLOAD(pairing_Frobenius1_Q_y1)
    $ => D      :MLOAD(pairing_Frobenius1_Q_y2)
    A           :MSTORE(lineDiffPointsBN254_P2_x1)
    B           :MSTORE(lineDiffPointsBN254_P2_x2)
    C           :MSTORE(lineDiffPointsBN254_P2_y1)
    D           :MSTORE(lineDiffPointsBN254_P2_y2)

    $ => A      :MLOAD(pairing_P_x)
    $ => B      :MLOAD(pairing_P_y)
    A           :MSTORE(lineDiffPointsBN254_Q_x)
    B           :MSTORE(lineDiffPointsBN254_Q_y)
                :CALL(lineDiffPointsBN254)
    $ => A      :MLOAD(pairing_f11_x)
    $ => B      :MLOAD(pairing_f11_y)
    A           :MSTORE(mulFp12BN254_a11_x)
    B           :MSTORE(mulFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_f12_x)
    $ => B      :MLOAD(pairing_f12_y)
    A           :MSTORE(mulFp12BN254_a12_x)
    B           :MSTORE(mulFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_f13_x)
    $ => B      :MLOAD(pairing_f13_y)
    A           :MSTORE(mulFp12BN254_a13_x)
    B           :MSTORE(mulFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_f21_x)
    $ => B      :MLOAD(pairing_f21_y)
    A           :MSTORE(mulFp12BN254_a21_x)
    B           :MSTORE(mulFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_f22_x)
    $ => B      :MLOAD(pairing_f22_y)
    A           :MSTORE(mulFp12BN254_a22_x)
    B           :MSTORE(mulFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_f23_x)
    $ => B      :MLOAD(pairing_f23_y)
    A           :MSTORE(mulFp12BN254_a23_x)
    B           :MSTORE(mulFp12BN254_a23_y)

    0n          :MSTORE(mulFp12BN254_b11_x)
    0n          :MSTORE(mulFp12BN254_b11_y)
    $ => A      :MLOAD(lineDiffPointsBN254_l12_x)
    $ => B      :MLOAD(lineDiffPointsBN254_l12_y)
    A           :MSTORE(mulFp12BN254_b12_x)
    B           :MSTORE(mulFp12BN254_b12_y)
    0n          :MSTORE(mulFp12BN254_b13_x)
    0n          :MSTORE(mulFp12BN254_b13_y)
    0n          :MSTORE(mulFp12BN254_b21_x)
    0n          :MSTORE(mulFp12BN254_b21_y)
    $ => A      :MLOAD(lineDiffPointsBN254_l22_x)
    $ => B      :MLOAD(lineDiffPointsBN254_l22_y)
    A           :MSTORE(mulFp12BN254_b22_x)
    B           :MSTORE(mulFp12BN254_b22_y)
    $ => A      :MLOAD(lineDiffPointsBN254_l23_x)
    $ => B      :MLOAD(lineDiffPointsBN254_l23_y)
    A           :MSTORE(mulFp12BN254_b23_x)
    B           :MSTORE(mulFp12BN254_b23_y)
                :CALL(mulFp12BN254)
    $ => A      :MLOAD(mulFp12BN254_c11_x)
    $ => B      :MLOAD(mulFp12BN254_c11_y)
    A           :MSTORE(pairing_f11_x)
    B           :MSTORE(pairing_f11_y)
    $ => A      :MLOAD(mulFp12BN254_c12_x)
    $ => B      :MLOAD(mulFp12BN254_c12_y)
    A           :MSTORE(pairing_f12_x)
    B           :MSTORE(pairing_f12_y)
    $ => A      :MLOAD(mulFp12BN254_c13_x)
    $ => B      :MLOAD(mulFp12BN254_c13_y)
    A           :MSTORE(pairing_f13_x)
    B           :MSTORE(pairing_f13_y)
    $ => A      :MLOAD(mulFp12BN254_c21_x)
    $ => B      :MLOAD(mulFp12BN254_c21_y)
    A           :MSTORE(pairing_f21_x)
    B           :MSTORE(pairing_f21_y)
    $ => A      :MLOAD(mulFp12BN254_c22_x)
    $ => B      :MLOAD(mulFp12BN254_c22_y)
    A           :MSTORE(pairing_f22_x)
    B           :MSTORE(pairing_f22_y)
    $ => A      :MLOAD(mulFp12BN254_c23_x)
    $ => B      :MLOAD(mulFp12BN254_c23_y)
    A           :MSTORE(pairing_f23_x)
    B           :MSTORE(pairing_f23_y)

    ; 3] R = R + Frobenius1(Q)
    $ => A      :MLOAD(pairing_R_x1)
    $ => B      :MLOAD(pairing_R_x2)
    $ => C      :MLOAD(pairing_R_y1)
    $ => D      :MLOAD(pairing_R_y2)
    A           :MSTORE(addPointBN254_P1_x1)
    B           :MSTORE(addPointBN254_P1_x2)
    C           :MSTORE(addPointBN254_P1_y1)
    D           :MSTORE(addPointBN254_P1_y2)
    $ => A      :MLOAD(pairing_Frobenius1_Q_x1)
    $ => B      :MLOAD(pairing_Frobenius1_Q_x2)
    $ => C      :MLOAD(pairing_Frobenius1_Q_y1)
    $ => D      :MLOAD(pairing_Frobenius1_Q_y2)
    A           :MSTORE(addPointBN254_P2_x1)
    B           :MSTORE(addPointBN254_P2_x2)
    C           :MSTORE(addPointBN254_P2_y1)
    D           :MSTORE(addPointBN254_P2_y2)
                :CALL(addPointBN254)
    $ => A      :MLOAD(addPointBN254_P3_x1)
    $ => B      :MLOAD(addPointBN254_P3_x2)
    $ => C      :MLOAD(addPointBN254_P3_y1)
    $ => D      :MLOAD(addPointBN254_P3_y2)
    A           :MSTORE(pairing_R_x1)
    B           :MSTORE(pairing_R_x2)
    C           :MSTORE(pairing_R_y1)
    D           :MSTORE(pairing_R_y2)

    ; 4] Given Frobenius1(Q) = (x,y) with x,y ∈ Fp2, compute -Frobenius2(Q) = (\gamma12·x̄, -\gamma13·ȳ)
    %FROBENIUS_GAMMA121 => A
    %FROBENIUS_GAMMA122 => B
    $ => C      :MLOAD(pairing_Frobenius1_Q_x1)
    $ => D      :MLOAD(pairing_Frobenius1_Q_x2)
    ${const.BN254_P - D} => D
                :CALL(mulFp2BN254)
    E           :MSTORE(pairing_nFrobenius2_Q_x1)
    C           :MSTORE(pairing_nFrobenius2_Q_x2)

    %FROBENIUS_GAMMA131_NEGATED => A
    %FROBENIUS_GAMMA132_NEGATED => B
    $ => C      :MLOAD(pairing_Frobenius1_Q_y1)
    $ => D      :MLOAD(pairing_Frobenius1_Q_y2)
    ${const.BN254_P - D} => D
                :CALL(mulFp2BN254)

    ; 5] f = f · line_{twist(R),twist(-Frobenius2(Q))}(P)
    $ => A      :MLOAD(pairing_nFrobenius2_Q_x1)
    $ => B      :MLOAD(pairing_nFrobenius2_Q_x2)
    C => D
    E => C
    A           :MSTORE(lineDiffPointsBN254_P2_x1)
    B           :MSTORE(lineDiffPointsBN254_P2_x2)
    C           :MSTORE(lineDiffPointsBN254_P2_y1)
    D           :MSTORE(lineDiffPointsBN254_P2_y2)
    $ => A      :MLOAD(pairing_R_x1)
    $ => B      :MLOAD(pairing_R_x2)
    $ => C      :MLOAD(pairing_R_y1)
    $ => D      :MLOAD(pairing_R_y2)
    A           :MSTORE(lineDiffPointsBN254_P1_x1)
    B           :MSTORE(lineDiffPointsBN254_P1_x2)
    C           :MSTORE(lineDiffPointsBN254_P1_y1)
    D           :MSTORE(lineDiffPointsBN254_P1_y2)

    $ => A      :MLOAD(pairing_P_x)
    $ => B      :MLOAD(pairing_P_y)
    A           :MSTORE(lineDiffPointsBN254_Q_x)
    B           :MSTORE(lineDiffPointsBN254_Q_y)
                :CALL(lineDiffPointsBN254)
    $ => A      :MLOAD(pairing_f11_x)
    $ => B      :MLOAD(pairing_f11_y)
    A           :MSTORE(mulFp12BN254_a11_x)
    B           :MSTORE(mulFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_f12_x)
    $ => B      :MLOAD(pairing_f12_y)
    A           :MSTORE(mulFp12BN254_a12_x)
    B           :MSTORE(mulFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_f13_x)
    $ => B      :MLOAD(pairing_f13_y)
    A           :MSTORE(mulFp12BN254_a13_x)
    B           :MSTORE(mulFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_f21_x)
    $ => B      :MLOAD(pairing_f21_y)
    A           :MSTORE(mulFp12BN254_a21_x)
    B           :MSTORE(mulFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_f22_x)
    $ => B      :MLOAD(pairing_f22_y)
    A           :MSTORE(mulFp12BN254_a22_x)
    B           :MSTORE(mulFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_f23_x)
    $ => B      :MLOAD(pairing_f23_y)
    A           :MSTORE(mulFp12BN254_a23_x)
    B           :MSTORE(mulFp12BN254_a23_y)

    0n          :MSTORE(mulFp12BN254_b11_x)
    0n          :MSTORE(mulFp12BN254_b11_y)
    $ => A      :MLOAD(lineDiffPointsBN254_l12_x)
    $ => B      :MLOAD(lineDiffPointsBN254_l12_y)
    A           :MSTORE(mulFp12BN254_b12_x)
    B           :MSTORE(mulFp12BN254_b12_y)
    0n          :MSTORE(mulFp12BN254_b13_x)
    0n          :MSTORE(mulFp12BN254_b13_y)
    0n          :MSTORE(mulFp12BN254_b21_x)
    0n          :MSTORE(mulFp12BN254_b21_y)
    $ => A      :MLOAD(lineDiffPointsBN254_l22_x)
    $ => B      :MLOAD(lineDiffPointsBN254_l22_y)
    A           :MSTORE(mulFp12BN254_b22_x)
    B           :MSTORE(mulFp12BN254_b22_y)
    $ => A      :MLOAD(lineDiffPointsBN254_l23_x)
    $ => B      :MLOAD(lineDiffPointsBN254_l23_y)
    A           :MSTORE(mulFp12BN254_b23_x)
    B           :MSTORE(mulFp12BN254_b23_y)
                :CALL(mulFp12BN254)
    $ => A      :MLOAD(mulFp12BN254_c11_x)
    $ => B      :MLOAD(mulFp12BN254_c11_y)
    A           :MSTORE(pairing_f11_x)
    B           :MSTORE(pairing_f11_y)
    $ => A      :MLOAD(mulFp12BN254_c12_x)
    $ => B      :MLOAD(mulFp12BN254_c12_y)
    A           :MSTORE(pairing_f12_x)
    B           :MSTORE(pairing_f12_y)
    $ => A      :MLOAD(mulFp12BN254_c13_x)
    $ => B      :MLOAD(mulFp12BN254_c13_y)
    A           :MSTORE(pairing_f13_x)
    B           :MSTORE(pairing_f13_y)
    $ => A      :MLOAD(mulFp12BN254_c21_x)
    $ => B      :MLOAD(mulFp12BN254_c21_y)
    A           :MSTORE(pairing_f21_x)
    B           :MSTORE(pairing_f21_y)
    $ => A      :MLOAD(mulFp12BN254_c22_x)
    $ => B      :MLOAD(mulFp12BN254_c22_y)
    A           :MSTORE(pairing_f22_x)
    B           :MSTORE(pairing_f22_y)
    $ => A      :MLOAD(mulFp12BN254_c23_x)
    $ => B      :MLOAD(mulFp12BN254_c23_y)
    A           :MSTORE(pairing_f23_x)
    B           :MSTORE(pairing_f23_y)

pairing_final_exponentiation:

    ; The easy part:
    ; ===========================================
    ; 1] f^(p⁶-1) = f̅·f⁻¹
    $ => A      :MLOAD(pairing_f11_x)
    $ => B      :MLOAD(pairing_f11_y)
    A           :MSTORE(inverseFp12BN254_a11_x)
    B           :MSTORE(inverseFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_f12_x)
    $ => B      :MLOAD(pairing_f12_y)
    A           :MSTORE(inverseFp12BN254_a12_x)
    B           :MSTORE(inverseFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_f13_x)
    $ => B      :MLOAD(pairing_f13_y)
    A           :MSTORE(inverseFp12BN254_a13_x)
    B           :MSTORE(inverseFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_f21_x)
    $ => B      :MLOAD(pairing_f21_y)
    A           :MSTORE(inverseFp12BN254_a21_x)
    B           :MSTORE(inverseFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_f22_x)
    $ => B      :MLOAD(pairing_f22_y)
    A           :MSTORE(inverseFp12BN254_a22_x)
    B           :MSTORE(inverseFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_f23_x)
    $ => B      :MLOAD(pairing_f23_y)
    A           :MSTORE(inverseFp12BN254_a23_x)
    B           :MSTORE(inverseFp12BN254_a23_y)
                :CALL(inverseFp12BN254)
    $ => A      :MLOAD(inverseFp12BN254_c11_x)
    $ => B      :MLOAD(inverseFp12BN254_c11_y)
    A           :MSTORE(mulFp12BN254_b11_x)
    B           :MSTORE(mulFp12BN254_b11_y)
    $ => A      :MLOAD(inverseFp12BN254_c12_x)
    $ => B      :MLOAD(inverseFp12BN254_c12_y)
    A           :MSTORE(mulFp12BN254_b12_x)
    B           :MSTORE(mulFp12BN254_b12_y)
    $ => A      :MLOAD(inverseFp12BN254_c13_x)
    $ => B      :MLOAD(inverseFp12BN254_c13_y)
    A           :MSTORE(mulFp12BN254_b13_x)
    B           :MSTORE(mulFp12BN254_b13_y)
    $ => A      :MLOAD(inverseFp12BN254_c21_x)
    $ => B      :MLOAD(inverseFp12BN254_c21_y)
    A           :MSTORE(mulFp12BN254_b21_x)
    B           :MSTORE(mulFp12BN254_b21_y)
    $ => A      :MLOAD(inverseFp12BN254_c22_x)
    $ => B      :MLOAD(inverseFp12BN254_c22_y)
    A           :MSTORE(mulFp12BN254_b22_x)
    B           :MSTORE(mulFp12BN254_b22_y)
    $ => A      :MLOAD(inverseFp12BN254_c23_x)
    $ => B      :MLOAD(inverseFp12BN254_c23_y)
    A           :MSTORE(mulFp12BN254_b23_x)
    B           :MSTORE(mulFp12BN254_b23_y)
    $ => A      :MLOAD(pairing_f11_x)
    $ => B      :MLOAD(pairing_f11_y)
    A           :MSTORE(mulFp12BN254_a11_x)
    B           :MSTORE(mulFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_f12_x)
    $ => B      :MLOAD(pairing_f12_y)
    A           :MSTORE(mulFp12BN254_a12_x)
    B           :MSTORE(mulFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_f13_x)
    $ => B      :MLOAD(pairing_f13_y)
    A           :MSTORE(mulFp12BN254_a13_x)
    B           :MSTORE(mulFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_f21_x)
    $ => B      :MLOAD(pairing_f21_y)
    ${const.BN254_P - A}          :MSTORE(mulFp12BN254_a21_x)
    ${const.BN254_P - B}          :MSTORE(mulFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_f22_x)
    $ => B      :MLOAD(pairing_f22_y)
    ${const.BN254_P - A}          :MSTORE(mulFp12BN254_a22_x)
    ${const.BN254_P - B}          :MSTORE(mulFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_f23_x)
    $ => B      :MLOAD(pairing_f23_y)
    ${const.BN254_P - A}          :MSTORE(mulFp12BN254_a23_x)
    ${const.BN254_P - B}          :MSTORE(mulFp12BN254_a23_y)
                :CALL(mulFp12BN254)
    $ => A      :MLOAD(mulFp12BN254_c11_x)
    $ => B      :MLOAD(mulFp12BN254_c11_y)
    A           :MSTORE(pairing_f11_x)
    B           :MSTORE(pairing_f11_y)
    $ => A      :MLOAD(mulFp12BN254_c12_x)
    $ => B      :MLOAD(mulFp12BN254_c12_y)
    A           :MSTORE(pairing_f12_x)
    B           :MSTORE(pairing_f12_y)
    $ => A      :MLOAD(mulFp12BN254_c13_x)
    $ => B      :MLOAD(mulFp12BN254_c13_y)
    A           :MSTORE(pairing_f13_x)
    B           :MSTORE(pairing_f13_y)
    $ => A      :MLOAD(mulFp12BN254_c21_x)
    $ => B      :MLOAD(mulFp12BN254_c21_y)
    A           :MSTORE(pairing_f21_x)
    B           :MSTORE(pairing_f21_y)
    $ => A      :MLOAD(mulFp12BN254_c22_x)
    $ => B      :MLOAD(mulFp12BN254_c22_y)
    A           :MSTORE(pairing_f22_x)
    B           :MSTORE(pairing_f22_y)
    $ => A      :MLOAD(mulFp12BN254_c23_x)
    $ => B      :MLOAD(mulFp12BN254_c23_y)
    A           :MSTORE(pairing_f23_x)
    B           :MSTORE(pairing_f23_y)

    ; 2] f^(p⁶-1)(p²-1) = (f^(p⁶-1))^p²·f^(p⁶-1)
    $ => A      :MLOAD(pairing_f11_x)
    $ => B      :MLOAD(pairing_f11_y)
    A           :MSTORE(frob2Fp12BN254_a11_x)
    B           :MSTORE(frob2Fp12BN254_a11_y)
    $ => A      :MLOAD(pairing_f12_x)
    $ => B      :MLOAD(pairing_f12_y)
    A           :MSTORE(frob2Fp12BN254_a12_x)
    B           :MSTORE(frob2Fp12BN254_a12_y)
    $ => A      :MLOAD(pairing_f13_x)
    $ => B      :MLOAD(pairing_f13_y)
    A           :MSTORE(frob2Fp12BN254_a13_x)
    B           :MSTORE(frob2Fp12BN254_a13_y)
    $ => A      :MLOAD(pairing_f21_x)
    $ => B      :MLOAD(pairing_f21_y)
    A           :MSTORE(frob2Fp12BN254_a21_x)
    B           :MSTORE(frob2Fp12BN254_a21_y)
    $ => A      :MLOAD(pairing_f22_x)
    $ => B      :MLOAD(pairing_f22_y)
    A           :MSTORE(frob2Fp12BN254_a22_x)
    B           :MSTORE(frob2Fp12BN254_a22_y)
    $ => A      :MLOAD(pairing_f23_x)
    $ => B      :MLOAD(pairing_f23_y)
    A           :MSTORE(frob2Fp12BN254_a23_x)
    B           :MSTORE(frob2Fp12BN254_a23_y)
                :CALL(frob2Fp12BN254)

    $ => A      :MLOAD(frob2Fp12BN254_c11_x)
    $ => B      :MLOAD(frob2Fp12BN254_c11_y)
    A           :MSTORE(mulFp12BN254_a11_x)
    B           :MSTORE(mulFp12BN254_a11_y)
    $ => A      :MLOAD(frob2Fp12BN254_c12_x)
    $ => B      :MLOAD(frob2Fp12BN254_c12_y)
    A           :MSTORE(mulFp12BN254_a12_x)
    B           :MSTORE(mulFp12BN254_a12_y)
    $ => A      :MLOAD(frob2Fp12BN254_c13_x)
    $ => B      :MLOAD(frob2Fp12BN254_c13_y)
    A           :MSTORE(mulFp12BN254_a13_x)
    B           :MSTORE(mulFp12BN254_a13_y)
    $ => A      :MLOAD(frob2Fp12BN254_c21_x)
    $ => B      :MLOAD(frob2Fp12BN254_c21_y)
    A           :MSTORE(mulFp12BN254_a21_x)
    B           :MSTORE(mulFp12BN254_a21_y)
    $ => A      :MLOAD(frob2Fp12BN254_c22_x)
    $ => B      :MLOAD(frob2Fp12BN254_c22_y)
    A           :MSTORE(mulFp12BN254_a22_x)
    B           :MSTORE(mulFp12BN254_a22_y)
    $ => A      :MLOAD(frob2Fp12BN254_c23_x)
    $ => B      :MLOAD(frob2Fp12BN254_c23_y)
    A           :MSTORE(mulFp12BN254_a23_x)
    B           :MSTORE(mulFp12BN254_a23_y)
    $ => A      :MLOAD(pairing_f11_x)
    $ => B      :MLOAD(pairing_f11_y)
    A           :MSTORE(mulFp12BN254_b11_x)
    B           :MSTORE(mulFp12BN254_b11_y)
    $ => A      :MLOAD(pairing_f12_x)
    $ => B      :MLOAD(pairing_f12_y)
    A           :MSTORE(mulFp12BN254_b12_x)
    B           :MSTORE(mulFp12BN254_b12_y)
    $ => A      :MLOAD(pairing_f13_x)
    $ => B      :MLOAD(pairing_f13_y)
    A           :MSTORE(mulFp12BN254_b13_x)
    B           :MSTORE(mulFp12BN254_b13_y)
    $ => A      :MLOAD(pairing_f21_x)
    $ => B      :MLOAD(pairing_f21_y)
    A           :MSTORE(mulFp12BN254_b21_x)
    B           :MSTORE(mulFp12BN254_b21_y)
    $ => A      :MLOAD(pairing_f22_x)
    $ => B      :MLOAD(pairing_f22_y)
    A           :MSTORE(mulFp12BN254_b22_x)
    B           :MSTORE(mulFp12BN254_b22_y)
    $ => A      :MLOAD(pairing_f23_x)
    $ => B      :MLOAD(pairing_f23_y)
    A           :MSTORE(mulFp12BN254_b23_x)
    B           :MSTORE(mulFp12BN254_b23_y)
                :CALL(mulFp12BN254)
    $ => A      :MLOAD(mulFp12BN254_c11_x)
    $ => B      :MLOAD(mulFp12BN254_c11_y)
    A           :MSTORE(pairing_f11_x)
    B           :MSTORE(pairing_f11_y)
    $ => A      :MLOAD(mulFp12BN254_c12_x)
    $ => B      :MLOAD(mulFp12BN254_c12_y)
    A           :MSTORE(pairing_f12_x)
    B           :MSTORE(pairing_f12_y)
    $ => A      :MLOAD(mulFp12BN254_c13_x)
    $ => B      :MLOAD(mulFp12BN254_c13_y)
    A           :MSTORE(pairing_f13_x)
    B           :MSTORE(pairing_f13_y)
    $ => A      :MLOAD(mulFp12BN254_c21_x)
    $ => B      :MLOAD(mulFp12BN254_c21_y)
    A           :MSTORE(pairing_f21_x)
    B           :MSTORE(pairing_f21_y)
    $ => A      :MLOAD(mulFp12BN254_c22_x)
    $ => B      :MLOAD(mulFp12BN254_c22_y)
    A           :MSTORE(pairing_f22_x)
    B           :MSTORE(pairing_f22_y)
    $ => A      :MLOAD(mulFp12BN254_c23_x)
    $ => B      :MLOAD(mulFp12BN254_c23_y)
    A           :MSTORE(pairing_f23_x)
    B           :MSTORE(pairing_f23_y)

    ; TODO: Join both parts?
    ; ===========================================

    ; The hard part:
    ; ===========================================
    ; 1] m^x, (m^x)^x, (m^{x²})^x
    %BN254_X    :MSTORE(expFp12BN254_e)
    $ => A      :MLOAD(pairing_f11_x)
    $ => B      :MLOAD(pairing_f11_y)
    A           :MSTORE(expFp12BN254_a11_x)
    B           :MSTORE(expFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_f12_x)
    $ => B      :MLOAD(pairing_f12_y)
    A           :MSTORE(expFp12BN254_a12_x)
    B           :MSTORE(expFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_f13_x)
    $ => B      :MLOAD(pairing_f13_y)
    A           :MSTORE(expFp12BN254_a13_x)
    B           :MSTORE(expFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_f21_x)
    $ => B      :MLOAD(pairing_f21_y)
    A           :MSTORE(expFp12BN254_a21_x)
    B           :MSTORE(expFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_f22_x)
    $ => B      :MLOAD(pairing_f22_y)
    A           :MSTORE(expFp12BN254_a22_x)
    B           :MSTORE(expFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_f23_x)
    $ => B      :MLOAD(pairing_f23_y)
    A           :MSTORE(expFp12BN254_a23_x)
    B           :MSTORE(expFp12BN254_a23_y)
                :CALL(expFp12BN254)
    $ => A      :MLOAD(expFp12BN254_c11_x)
    $ => B      :MLOAD(expFp12BN254_c11_y)
    A           :MSTORE(pairing_mx11_x)
    B           :MSTORE(pairing_mx11_y)
    $ => A      :MLOAD(expFp12BN254_c12_x)
    $ => B      :MLOAD(expFp12BN254_c12_y)
    A           :MSTORE(pairing_mx12_x)
    B           :MSTORE(pairing_mx12_y)
    $ => A      :MLOAD(expFp12BN254_c13_x)
    $ => B      :MLOAD(expFp12BN254_c13_y)
    A           :MSTORE(pairing_mx13_x)
    B           :MSTORE(pairing_mx13_y)
    $ => A      :MLOAD(expFp12BN254_c21_x)
    $ => B      :MLOAD(expFp12BN254_c21_y)
    A           :MSTORE(pairing_mx21_x)
    B           :MSTORE(pairing_mx21_y)
    $ => A      :MLOAD(expFp12BN254_c22_x)
    $ => B      :MLOAD(expFp12BN254_c22_y)
    A           :MSTORE(pairing_mx22_x)
    B           :MSTORE(pairing_mx22_y)
    $ => A      :MLOAD(expFp12BN254_c23_x)
    $ => B      :MLOAD(expFp12BN254_c23_y)
    A           :MSTORE(pairing_mx23_x)
    B           :MSTORE(pairing_mx23_y)

    %BN254_X    :MSTORE(expFp12BN254_e)
    $ => A      :MLOAD(pairing_mx11_x)
    $ => B      :MLOAD(pairing_mx11_y)
    A           :MSTORE(expFp12BN254_a11_x)
    B           :MSTORE(expFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_mx12_x)
    $ => B      :MLOAD(pairing_mx12_y)
    A           :MSTORE(expFp12BN254_a12_x)
    B           :MSTORE(expFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_mx13_x)
    $ => B      :MLOAD(pairing_mx13_y)
    A           :MSTORE(expFp12BN254_a13_x)
    B           :MSTORE(expFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_mx21_x)
    $ => B      :MLOAD(pairing_mx21_y)
    A           :MSTORE(expFp12BN254_a21_x)
    B           :MSTORE(expFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_mx22_x)
    $ => B      :MLOAD(pairing_mx22_y)
    A           :MSTORE(expFp12BN254_a22_x)
    B           :MSTORE(expFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_mx23_x)
    $ => B      :MLOAD(pairing_mx23_y)
    A           :MSTORE(expFp12BN254_a23_x)
    B           :MSTORE(expFp12BN254_a23_y)
                :CALL(expFp12BN254)
    $ => A      :MLOAD(expFp12BN254_c11_x)
    $ => B      :MLOAD(expFp12BN254_c11_y)
    A           :MSTORE(pairing_mxx11_x)
    B           :MSTORE(pairing_mxx11_y)
    $ => A      :MLOAD(expFp12BN254_c12_x)
    $ => B      :MLOAD(expFp12BN254_c12_y)
    A           :MSTORE(pairing_mxx12_x)
    B           :MSTORE(pairing_mxx12_y)
    $ => A      :MLOAD(expFp12BN254_c13_x)
    $ => B      :MLOAD(expFp12BN254_c13_y)
    A           :MSTORE(pairing_mxx13_x)
    B           :MSTORE(pairing_mxx13_y)
    $ => A      :MLOAD(expFp12BN254_c21_x)
    $ => B      :MLOAD(expFp12BN254_c21_y)
    A           :MSTORE(pairing_mxx21_x)
    B           :MSTORE(pairing_mxx21_y)
    $ => A      :MLOAD(expFp12BN254_c22_x)
    $ => B      :MLOAD(expFp12BN254_c22_y)
    A           :MSTORE(pairing_mxx22_x)
    B           :MSTORE(pairing_mxx22_y)
    $ => A      :MLOAD(expFp12BN254_c23_x)
    $ => B      :MLOAD(expFp12BN254_c23_y)
    A           :MSTORE(pairing_mxx23_x)
    B           :MSTORE(pairing_mxx23_y)

    %BN254_X    :MSTORE(expFp12BN254_e)
    $ => A      :MLOAD(pairing_mxx11_x)
    $ => B      :MLOAD(pairing_mxx11_y)
    A           :MSTORE(expFp12BN254_a11_x)
    B           :MSTORE(expFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_mxx12_x)
    $ => B      :MLOAD(pairing_mxx12_y)
    A           :MSTORE(expFp12BN254_a12_x)
    B           :MSTORE(expFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_mxx13_x)
    $ => B      :MLOAD(pairing_mxx13_y)
    A           :MSTORE(expFp12BN254_a13_x)
    B           :MSTORE(expFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_mxx21_x)
    $ => B      :MLOAD(pairing_mxx21_y)
    A           :MSTORE(expFp12BN254_a21_x)
    B           :MSTORE(expFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_mxx22_x)
    $ => B      :MLOAD(pairing_mxx22_y)
    A           :MSTORE(expFp12BN254_a22_x)
    B           :MSTORE(expFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_mxx23_x)
    $ => B      :MLOAD(pairing_mxx23_y)
    A           :MSTORE(expFp12BN254_a23_x)
    B           :MSTORE(expFp12BN254_a23_y)
                :CALL(expFp12BN254)
    $ => A      :MLOAD(expFp12BN254_c11_x)
    $ => B      :MLOAD(expFp12BN254_c11_y)
    A           :MSTORE(pairing_mxxx11_x)
    B           :MSTORE(pairing_mxxx11_y)
    $ => A      :MLOAD(expFp12BN254_c12_x)
    $ => B      :MLOAD(expFp12BN254_c12_y)
    A           :MSTORE(pairing_mxxx12_x)
    B           :MSTORE(pairing_mxxx12_y)
    $ => A      :MLOAD(expFp12BN254_c13_x)
    $ => B      :MLOAD(expFp12BN254_c13_y)
    A           :MSTORE(pairing_mxxx13_x)
    B           :MSTORE(pairing_mxxx13_y)
    $ => A      :MLOAD(expFp12BN254_c21_x)
    $ => B      :MLOAD(expFp12BN254_c21_y)
    A           :MSTORE(pairing_mxxx21_x)
    B           :MSTORE(pairing_mxxx21_y)
    $ => A      :MLOAD(expFp12BN254_c22_x)
    $ => B      :MLOAD(expFp12BN254_c22_y)
    A           :MSTORE(pairing_mxxx22_x)
    B           :MSTORE(pairing_mxxx22_y)
    $ => A      :MLOAD(expFp12BN254_c23_x)
    $ => B      :MLOAD(expFp12BN254_c23_y)
    A           :MSTORE(pairing_mxxx23_x)
    B           :MSTORE(pairing_mxxx23_y)

    ; 2] m^p, m^p², m^p³, (m^x)^p, (m^x²)^p, (m^x³)^p, (m^x²)^p²
    $ => A      :MLOAD(pairing_f11_x)
    $ => B      :MLOAD(pairing_f11_y)
    A           :MSTORE(frobFp12BN254_a11_x)
    B           :MSTORE(frobFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_f12_x)
    $ => B      :MLOAD(pairing_f12_y)
    A           :MSTORE(frobFp12BN254_a12_x)
    B           :MSTORE(frobFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_f13_x)
    $ => B      :MLOAD(pairing_f13_y)
    A           :MSTORE(frobFp12BN254_a13_x)
    B           :MSTORE(frobFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_f21_x)
    $ => B      :MLOAD(pairing_f21_y)
    A           :MSTORE(frobFp12BN254_a21_x)
    B           :MSTORE(frobFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_f22_x)
    $ => B      :MLOAD(pairing_f22_y)
    A           :MSTORE(frobFp12BN254_a22_x)
    B           :MSTORE(frobFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_f23_x)
    $ => B      :MLOAD(pairing_f23_y)
    A           :MSTORE(frobFp12BN254_a23_x)
    B           :MSTORE(frobFp12BN254_a23_y)
                :CALL(frobFp12BN254)
    $ => A      :MLOAD(frobFp12BN254_c11_x)
    $ => B      :MLOAD(frobFp12BN254_c11_y)
    A           :MSTORE(pairing_mp11_x)
    B           :MSTORE(pairing_mp11_y)
    $ => A      :MLOAD(frobFp12BN254_c12_x)
    $ => B      :MLOAD(frobFp12BN254_c12_y)
    A           :MSTORE(pairing_mp12_x)
    B           :MSTORE(pairing_mp12_y)
    $ => A      :MLOAD(frobFp12BN254_c13_x)
    $ => B      :MLOAD(frobFp12BN254_c13_y)
    A           :MSTORE(pairing_mp13_x)
    B           :MSTORE(pairing_mp13_y)
    $ => A      :MLOAD(frobFp12BN254_c21_x)
    $ => B      :MLOAD(frobFp12BN254_c21_y)
    A           :MSTORE(pairing_mp21_x)
    B           :MSTORE(pairing_mp21_y)
    $ => A      :MLOAD(frobFp12BN254_c22_x)
    $ => B      :MLOAD(frobFp12BN254_c22_y)
    A           :MSTORE(pairing_mp22_x)
    B           :MSTORE(pairing_mp22_y)
    $ => A      :MLOAD(frobFp12BN254_c23_x)
    $ => B      :MLOAD(frobFp12BN254_c23_y)
    A           :MSTORE(pairing_mp23_x)
    B           :MSTORE(pairing_mp23_y)
    ; ${dump(mem.pairing_mp11_x,mem.pairing_mp11_y,mem.pairing_mp12_x,mem.pairing_mp12_y,mem.pairing_mp13_x,mem.pairing_mp13_y,mem.pairing_mp21_x,mem.pairing_mp21_y,mem.pairing_mp22_x,mem.pairing_mp22_y,mem.pairing_mp23_x,mem.pairing_mp23_y)}

    $ => A      :MLOAD(pairing_f11_x)
    $ => B      :MLOAD(pairing_f11_y)
    A           :MSTORE(frob2Fp12BN254_a11_x)
    B           :MSTORE(frob2Fp12BN254_a11_y)
    $ => A      :MLOAD(pairing_f12_x)
    $ => B      :MLOAD(pairing_f12_y)
    A           :MSTORE(frob2Fp12BN254_a12_x)
    B           :MSTORE(frob2Fp12BN254_a12_y)
    $ => A      :MLOAD(pairing_f13_x)
    $ => B      :MLOAD(pairing_f13_y)
    A           :MSTORE(frob2Fp12BN254_a13_x)
    B           :MSTORE(frob2Fp12BN254_a13_y)
    $ => A      :MLOAD(pairing_f21_x)
    $ => B      :MLOAD(pairing_f21_y)
    A           :MSTORE(frob2Fp12BN254_a21_x)
    B           :MSTORE(frob2Fp12BN254_a21_y)
    $ => A      :MLOAD(pairing_f22_x)
    $ => B      :MLOAD(pairing_f22_y)
    A           :MSTORE(frob2Fp12BN254_a22_x)
    B           :MSTORE(frob2Fp12BN254_a22_y)
    $ => A      :MLOAD(pairing_f23_x)
    $ => B      :MLOAD(pairing_f23_y)
    A           :MSTORE(frob2Fp12BN254_a23_x)
    B           :MSTORE(frob2Fp12BN254_a23_y)
                :CALL(frob2Fp12BN254)
    $ => A      :MLOAD(frob2Fp12BN254_c11_x)
    $ => B      :MLOAD(frob2Fp12BN254_c11_y)
    A           :MSTORE(pairing_mpp11_x)
    B           :MSTORE(pairing_mpp11_y)
    $ => A      :MLOAD(frob2Fp12BN254_c12_x)
    $ => B      :MLOAD(frob2Fp12BN254_c12_y)
    A           :MSTORE(pairing_mpp12_x)
    B           :MSTORE(pairing_mpp12_y)
    $ => A      :MLOAD(frob2Fp12BN254_c13_x)
    $ => B      :MLOAD(frob2Fp12BN254_c13_y)
    A           :MSTORE(pairing_mpp13_x)
    B           :MSTORE(pairing_mpp13_y)
    $ => A      :MLOAD(frob2Fp12BN254_c21_x)
    $ => B      :MLOAD(frob2Fp12BN254_c21_y)
    A           :MSTORE(pairing_mpp21_x)
    B           :MSTORE(pairing_mpp21_y)
    $ => A      :MLOAD(frob2Fp12BN254_c22_x)
    $ => B      :MLOAD(frob2Fp12BN254_c22_y)
    A           :MSTORE(pairing_mpp22_x)
    B           :MSTORE(pairing_mpp22_y)
    $ => A      :MLOAD(frob2Fp12BN254_c23_x)
    $ => B      :MLOAD(frob2Fp12BN254_c23_y)
    A           :MSTORE(pairing_mpp23_x)
    B           :MSTORE(pairing_mpp23_y)
    ; ${dump(mem.pairing_mpp11_x,mem.pairing_mpp11_y,mem.pairing_mpp12_x,mem.pairing_mpp12_y,mem.pairing_mpp13_x,mem.pairing_mpp13_y,mem.pairing_mpp21_x,mem.pairing_mpp21_y,mem.pairing_mpp22_x,mem.pairing_mpp22_y,mem.pairing_mpp23_x,mem.pairing_mpp23_y)}

    $ => A      :MLOAD(pairing_f11_x)
    $ => B      :MLOAD(pairing_f11_y)
    A           :MSTORE(frob3Fp12BN254_a11_x)
    B           :MSTORE(frob3Fp12BN254_a11_y)
    $ => A      :MLOAD(pairing_f12_x)
    $ => B      :MLOAD(pairing_f12_y)
    A           :MSTORE(frob3Fp12BN254_a12_x)
    B           :MSTORE(frob3Fp12BN254_a12_y)
    $ => A      :MLOAD(pairing_f13_x)
    $ => B      :MLOAD(pairing_f13_y)
    A           :MSTORE(frob3Fp12BN254_a13_x)
    B           :MSTORE(frob3Fp12BN254_a13_y)
    $ => A      :MLOAD(pairing_f21_x)
    $ => B      :MLOAD(pairing_f21_y)
    A           :MSTORE(frob3Fp12BN254_a21_x)
    B           :MSTORE(frob3Fp12BN254_a21_y)
    $ => A      :MLOAD(pairing_f22_x)
    $ => B      :MLOAD(pairing_f22_y)
    A           :MSTORE(frob3Fp12BN254_a22_x)
    B           :MSTORE(frob3Fp12BN254_a22_y)
    $ => A      :MLOAD(pairing_f23_x)
    $ => B      :MLOAD(pairing_f23_y)
    A           :MSTORE(frob3Fp12BN254_a23_x)
    B           :MSTORE(frob3Fp12BN254_a23_y)
                :CALL(frob3Fp12BN254)
    $ => A      :MLOAD(frob3Fp12BN254_c11_x)
    $ => B      :MLOAD(frob3Fp12BN254_c11_y)
    A           :MSTORE(pairing_mppp11_x)
    B           :MSTORE(pairing_mppp11_y)
    $ => A      :MLOAD(frob3Fp12BN254_c12_x)
    $ => B      :MLOAD(frob3Fp12BN254_c12_y)
    A           :MSTORE(pairing_mppp12_x)
    B           :MSTORE(pairing_mppp12_y)
    $ => A      :MLOAD(frob3Fp12BN254_c13_x)
    $ => B      :MLOAD(frob3Fp12BN254_c13_y)
    A           :MSTORE(pairing_mppp13_x)
    B           :MSTORE(pairing_mppp13_y)
    $ => A      :MLOAD(frob3Fp12BN254_c21_x)
    $ => B      :MLOAD(frob3Fp12BN254_c21_y)
    A           :MSTORE(pairing_mppp21_x)
    B           :MSTORE(pairing_mppp21_y)
    $ => A      :MLOAD(frob3Fp12BN254_c22_x)
    $ => B      :MLOAD(frob3Fp12BN254_c22_y)
    A           :MSTORE(pairing_mppp22_x)
    B           :MSTORE(pairing_mppp22_y)
    $ => A      :MLOAD(frob3Fp12BN254_c23_x)
    $ => B      :MLOAD(frob3Fp12BN254_c23_y)
    A           :MSTORE(pairing_mppp23_x)
    B           :MSTORE(pairing_mppp23_y)
    ; ${dump(mem.pairing_mppp11_x,mem.pairing_mppp11_y,mem.pairing_mppp12_x,mem.pairing_mppp12_y,mem.pairing_mppp13_x,mem.pairing_mppp13_y,mem.pairing_mppp21_x,mem.pairing_mppp21_y,mem.pairing_mppp22_x,mem.pairing_mppp22_y,mem.pairing_mppp23_x,mem.pairing_mppp23_y)}

    $ => A      :MLOAD(pairing_mx11_x)
    $ => B      :MLOAD(pairing_mx11_y)
    A           :MSTORE(frobFp12BN254_a11_x)
    B           :MSTORE(frobFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_mx12_x)
    $ => B      :MLOAD(pairing_mx12_y)
    A           :MSTORE(frobFp12BN254_a12_x)
    B           :MSTORE(frobFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_mx13_x)
    $ => B      :MLOAD(pairing_mx13_y)
    A           :MSTORE(frobFp12BN254_a13_x)
    B           :MSTORE(frobFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_mx21_x)
    $ => B      :MLOAD(pairing_mx21_y)
    A           :MSTORE(frobFp12BN254_a21_x)
    B           :MSTORE(frobFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_mx22_x)
    $ => B      :MLOAD(pairing_mx22_y)
    A           :MSTORE(frobFp12BN254_a22_x)
    B           :MSTORE(frobFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_mx23_x)
    $ => B      :MLOAD(pairing_mx23_y)
    A           :MSTORE(frobFp12BN254_a23_x)
    B           :MSTORE(frobFp12BN254_a23_y)
                :CALL(frobFp12BN254)
    $ => A      :MLOAD(frobFp12BN254_c11_x)
    $ => B      :MLOAD(frobFp12BN254_c11_y)
    A           :MSTORE(pairing_mxp11_x)
    B           :MSTORE(pairing_mxp11_y)
    $ => A      :MLOAD(frobFp12BN254_c12_x)
    $ => B      :MLOAD(frobFp12BN254_c12_y)
    A           :MSTORE(pairing_mxp12_x)
    B           :MSTORE(pairing_mxp12_y)
    $ => A      :MLOAD(frobFp12BN254_c13_x)
    $ => B      :MLOAD(frobFp12BN254_c13_y)
    A           :MSTORE(pairing_mxp13_x)
    B           :MSTORE(pairing_mxp13_y)
    $ => A      :MLOAD(frobFp12BN254_c21_x)
    $ => B      :MLOAD(frobFp12BN254_c21_y)
    A           :MSTORE(pairing_mxp21_x)
    B           :MSTORE(pairing_mxp21_y)
    $ => A      :MLOAD(frobFp12BN254_c22_x)
    $ => B      :MLOAD(frobFp12BN254_c22_y)
    A           :MSTORE(pairing_mxp22_x)
    B           :MSTORE(pairing_mxp22_y)
    $ => A      :MLOAD(frobFp12BN254_c23_x)
    $ => B      :MLOAD(frobFp12BN254_c23_y)
    A           :MSTORE(pairing_mxp23_x)
    B           :MSTORE(pairing_mxp23_y)

    $ => A      :MLOAD(pairing_mxx11_x)
    $ => B      :MLOAD(pairing_mxx11_y)
    A           :MSTORE(frobFp12BN254_a11_x)
    B           :MSTORE(frobFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_mxx12_x)
    $ => B      :MLOAD(pairing_mxx12_y)
    A           :MSTORE(frobFp12BN254_a12_x)
    B           :MSTORE(frobFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_mxx13_x)
    $ => B      :MLOAD(pairing_mxx13_y)
    A           :MSTORE(frobFp12BN254_a13_x)
    B           :MSTORE(frobFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_mxx21_x)
    $ => B      :MLOAD(pairing_mxx21_y)
    A           :MSTORE(frobFp12BN254_a21_x)
    B           :MSTORE(frobFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_mxx22_x)
    $ => B      :MLOAD(pairing_mxx22_y)
    A           :MSTORE(frobFp12BN254_a22_x)
    B           :MSTORE(frobFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_mxx23_x)
    $ => B      :MLOAD(pairing_mxx23_y)
    A           :MSTORE(frobFp12BN254_a23_x)
    B           :MSTORE(frobFp12BN254_a23_y)
                :CALL(frobFp12BN254)
    $ => A      :MLOAD(frobFp12BN254_c11_x)
    $ => B      :MLOAD(frobFp12BN254_c11_y)
    A           :MSTORE(pairing_mxxp11_x)
    B           :MSTORE(pairing_mxxp11_y)
    $ => A      :MLOAD(frobFp12BN254_c12_x)
    $ => B      :MLOAD(frobFp12BN254_c12_y)
    A           :MSTORE(pairing_mxxp12_x)
    B           :MSTORE(pairing_mxxp12_y)
    $ => A      :MLOAD(frobFp12BN254_c13_x)
    $ => B      :MLOAD(frobFp12BN254_c13_y)
    A           :MSTORE(pairing_mxxp13_x)
    B           :MSTORE(pairing_mxxp13_y)
    $ => A      :MLOAD(frobFp12BN254_c21_x)
    $ => B      :MLOAD(frobFp12BN254_c21_y)
    A           :MSTORE(pairing_mxxp21_x)
    B           :MSTORE(pairing_mxxp21_y)
    $ => A      :MLOAD(frobFp12BN254_c22_x)
    $ => B      :MLOAD(frobFp12BN254_c22_y)
    A           :MSTORE(pairing_mxxp22_x)
    B           :MSTORE(pairing_mxxp22_y)
    $ => A      :MLOAD(frobFp12BN254_c23_x)
    $ => B      :MLOAD(frobFp12BN254_c23_y)
    A           :MSTORE(pairing_mxxp23_x)
    B           :MSTORE(pairing_mxxp23_y)

    $ => A      :MLOAD(pairing_mxxx11_x)
    $ => B      :MLOAD(pairing_mxxx11_y)
    A           :MSTORE(frobFp12BN254_a11_x)
    B           :MSTORE(frobFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_mxxx12_x)
    $ => B      :MLOAD(pairing_mxxx12_y)
    A           :MSTORE(frobFp12BN254_a12_x)
    B           :MSTORE(frobFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_mxxx13_x)
    $ => B      :MLOAD(pairing_mxxx13_y)
    A           :MSTORE(frobFp12BN254_a13_x)
    B           :MSTORE(frobFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_mxxx21_x)
    $ => B      :MLOAD(pairing_mxxx21_y)
    A           :MSTORE(frobFp12BN254_a21_x)
    B           :MSTORE(frobFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_mxxx22_x)
    $ => B      :MLOAD(pairing_mxxx22_y)
    A           :MSTORE(frobFp12BN254_a22_x)
    B           :MSTORE(frobFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_mxxx23_x)
    $ => B      :MLOAD(pairing_mxxx23_y)
    A           :MSTORE(frobFp12BN254_a23_x)
    B           :MSTORE(frobFp12BN254_a23_y)
                :CALL(frobFp12BN254)
    $ => A      :MLOAD(frobFp12BN254_c11_x)
    $ => B      :MLOAD(frobFp12BN254_c11_y)
    A           :MSTORE(pairing_mxxxp11_x)
    B           :MSTORE(pairing_mxxxp11_y)
    $ => A      :MLOAD(frobFp12BN254_c12_x)
    $ => B      :MLOAD(frobFp12BN254_c12_y)
    A           :MSTORE(pairing_mxxxp12_x)
    B           :MSTORE(pairing_mxxxp12_y)
    $ => A      :MLOAD(frobFp12BN254_c13_x)
    $ => B      :MLOAD(frobFp12BN254_c13_y)
    A           :MSTORE(pairing_mxxxp13_x)
    B           :MSTORE(pairing_mxxxp13_y)
    $ => A      :MLOAD(frobFp12BN254_c21_x)
    $ => B      :MLOAD(frobFp12BN254_c21_y)
    A           :MSTORE(pairing_mxxxp21_x)
    B           :MSTORE(pairing_mxxxp21_y)
    $ => A      :MLOAD(frobFp12BN254_c22_x)
    $ => B      :MLOAD(frobFp12BN254_c22_y)
    A           :MSTORE(pairing_mxxxp22_x)
    B           :MSTORE(pairing_mxxxp22_y)
    $ => A      :MLOAD(frobFp12BN254_c23_x)
    $ => B      :MLOAD(frobFp12BN254_c23_y)
    A           :MSTORE(pairing_mxxxp23_x)
    B           :MSTORE(pairing_mxxxp23_y)

    $ => A      :MLOAD(pairing_mxx11_x)
    $ => B      :MLOAD(pairing_mxx11_y)
    A           :MSTORE(frob2Fp12BN254_a11_x)
    B           :MSTORE(frob2Fp12BN254_a11_y)
    $ => A      :MLOAD(pairing_mxx12_x)
    $ => B      :MLOAD(pairing_mxx12_y)
    A           :MSTORE(frob2Fp12BN254_a12_x)
    B           :MSTORE(frob2Fp12BN254_a12_y)
    $ => A      :MLOAD(pairing_mxx13_x)
    $ => B      :MLOAD(pairing_mxx13_y)
    A           :MSTORE(frob2Fp12BN254_a13_x)
    B           :MSTORE(frob2Fp12BN254_a13_y)
    $ => A      :MLOAD(pairing_mxx21_x)
    $ => B      :MLOAD(pairing_mxx21_y)
    A           :MSTORE(frob2Fp12BN254_a21_x)
    B           :MSTORE(frob2Fp12BN254_a21_y)
    $ => A      :MLOAD(pairing_mxx22_x)
    $ => B      :MLOAD(pairing_mxx22_y)
    A           :MSTORE(frob2Fp12BN254_a22_x)
    B           :MSTORE(frob2Fp12BN254_a22_y)
    $ => A      :MLOAD(pairing_mxx23_x)
    $ => B      :MLOAD(pairing_mxx23_y)
    A           :MSTORE(frob2Fp12BN254_a23_x)
    B           :MSTORE(frob2Fp12BN254_a23_y)
                :CALL(frob2Fp12BN254)
    $ => A      :MLOAD(frob2Fp12BN254_c11_x)
    $ => B      :MLOAD(frob2Fp12BN254_c11_y)
    A           :MSTORE(pairing_mxxpp11_x)
    B           :MSTORE(pairing_mxxpp11_y)
    $ => A      :MLOAD(frob2Fp12BN254_c12_x)
    $ => B      :MLOAD(frob2Fp12BN254_c12_y)
    A           :MSTORE(pairing_mxxpp12_x)
    B           :MSTORE(pairing_mxxpp12_y)
    $ => A      :MLOAD(frob2Fp12BN254_c13_x)
    $ => B      :MLOAD(frob2Fp12BN254_c13_y)
    A           :MSTORE(pairing_mxxpp13_x)
    B           :MSTORE(pairing_mxxpp13_y)
    $ => A      :MLOAD(frob2Fp12BN254_c21_x)
    $ => B      :MLOAD(frob2Fp12BN254_c21_y)
    A           :MSTORE(pairing_mxxpp21_x)
    B           :MSTORE(pairing_mxxpp21_y)
    $ => A      :MLOAD(frob2Fp12BN254_c22_x)
    $ => B      :MLOAD(frob2Fp12BN254_c22_y)
    A           :MSTORE(pairing_mxxpp22_x)
    B           :MSTORE(pairing_mxxpp22_y)
    $ => A      :MLOAD(frob2Fp12BN254_c23_x)
    $ => B      :MLOAD(frob2Fp12BN254_c23_y)
    A           :MSTORE(pairing_mxxpp23_x)
    B           :MSTORE(pairing_mxxpp23_y)
    
    ; TODO: Some of the following can be directly computed and stored in the previous step

    ; 3] y1 = m^p·m^p²·m^p³
    $ => A      :MLOAD(pairing_mp11_x)
    $ => B      :MLOAD(pairing_mp11_y)
    A           :MSTORE(mulFp12BN254_a11_x)
    B           :MSTORE(mulFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_mp12_x)
    $ => B      :MLOAD(pairing_mp12_y)
    A           :MSTORE(mulFp12BN254_a12_x)
    B           :MSTORE(mulFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_mp13_x)
    $ => B      :MLOAD(pairing_mp13_y)
    A           :MSTORE(mulFp12BN254_a13_x)
    B           :MSTORE(mulFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_mp21_x)
    $ => B      :MLOAD(pairing_mp21_y)
    A           :MSTORE(mulFp12BN254_a21_x)
    B           :MSTORE(mulFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_mp22_x)
    $ => B      :MLOAD(pairing_mp22_y)
    A           :MSTORE(mulFp12BN254_a22_x)
    B           :MSTORE(mulFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_mp23_x)
    $ => B      :MLOAD(pairing_mp23_y)
    A           :MSTORE(mulFp12BN254_a23_x)
    B           :MSTORE(mulFp12BN254_a23_y)
    $ => A      :MLOAD(pairing_mpp11_x)
    $ => B      :MLOAD(pairing_mpp11_y)
    A           :MSTORE(mulFp12BN254_b11_x)
    B           :MSTORE(mulFp12BN254_b11_y)
    $ => A      :MLOAD(pairing_mpp12_x)
    $ => B      :MLOAD(pairing_mpp12_y)
    A           :MSTORE(mulFp12BN254_b12_x)
    B           :MSTORE(mulFp12BN254_b12_y)
    $ => A      :MLOAD(pairing_mpp13_x)
    $ => B      :MLOAD(pairing_mpp13_y)
    A           :MSTORE(mulFp12BN254_b13_x)
    B           :MSTORE(mulFp12BN254_b13_y)
    $ => A      :MLOAD(pairing_mpp21_x)
    $ => B      :MLOAD(pairing_mpp21_y)
    A           :MSTORE(mulFp12BN254_b21_x)
    B           :MSTORE(mulFp12BN254_b21_y)
    $ => A      :MLOAD(pairing_mpp22_x)
    $ => B      :MLOAD(pairing_mpp22_y)
    A           :MSTORE(mulFp12BN254_b22_x)
    B           :MSTORE(mulFp12BN254_b22_y)
    $ => A      :MLOAD(pairing_mpp23_x)
    $ => B      :MLOAD(pairing_mpp23_y)
    A           :MSTORE(mulFp12BN254_b23_x)
    B           :MSTORE(mulFp12BN254_b23_y)
                :CALL(mulFp12BN254)
    $ => A      :MLOAD(mulFp12BN254_c11_x)
    $ => B      :MLOAD(mulFp12BN254_c11_y)
    A           :MSTORE(mulFp12BN254_a11_x)
    B           :MSTORE(mulFp12BN254_a11_y)
    $ => A      :MLOAD(mulFp12BN254_c12_x)
    $ => B      :MLOAD(mulFp12BN254_c12_y)
    A           :MSTORE(mulFp12BN254_a12_x)
    B           :MSTORE(mulFp12BN254_a12_y)
    $ => A      :MLOAD(mulFp12BN254_c13_x)
    $ => B      :MLOAD(mulFp12BN254_c13_y)
    A           :MSTORE(mulFp12BN254_a13_x)
    B           :MSTORE(mulFp12BN254_a13_y)
    $ => A      :MLOAD(mulFp12BN254_c21_x)
    $ => B      :MLOAD(mulFp12BN254_c21_y)
    A           :MSTORE(mulFp12BN254_a21_x)
    B           :MSTORE(mulFp12BN254_a21_y)
    $ => A      :MLOAD(mulFp12BN254_c22_x)
    $ => B      :MLOAD(mulFp12BN254_c22_y)
    A           :MSTORE(mulFp12BN254_a22_x)
    B           :MSTORE(mulFp12BN254_a22_y)
    $ => A      :MLOAD(mulFp12BN254_c23_x)
    $ => B      :MLOAD(mulFp12BN254_c23_y)
    A           :MSTORE(mulFp12BN254_a23_x)
    B           :MSTORE(mulFp12BN254_a23_y)
    $ => A      :MLOAD(pairing_mppp11_x)
    $ => B      :MLOAD(pairing_mppp11_y)
    A           :MSTORE(mulFp12BN254_b11_x)
    B           :MSTORE(mulFp12BN254_b11_y)
    $ => A      :MLOAD(pairing_mppp12_x)
    $ => B      :MLOAD(pairing_mppp12_y)
    A           :MSTORE(mulFp12BN254_b12_x)
    B           :MSTORE(mulFp12BN254_b12_y)
    $ => A      :MLOAD(pairing_mppp13_x)
    $ => B      :MLOAD(pairing_mppp13_y)
    A           :MSTORE(mulFp12BN254_b13_x)
    B           :MSTORE(mulFp12BN254_b13_y)
    $ => A      :MLOAD(pairing_mppp21_x)
    $ => B      :MLOAD(pairing_mppp21_y)
    A           :MSTORE(mulFp12BN254_b21_x)
    B           :MSTORE(mulFp12BN254_b21_y)
    $ => A      :MLOAD(pairing_mppp22_x)
    $ => B      :MLOAD(pairing_mppp22_y)
    A           :MSTORE(mulFp12BN254_b22_x)
    B           :MSTORE(mulFp12BN254_b22_y)
    $ => A      :MLOAD(pairing_mppp23_x)
    $ => B      :MLOAD(pairing_mppp23_y)
    A           :MSTORE(mulFp12BN254_b23_x)
    B           :MSTORE(mulFp12BN254_b23_y)
                :CALL(mulFp12BN254)
    $ => A      :MLOAD(mulFp12BN254_c11_x)
    $ => B      :MLOAD(mulFp12BN254_c11_y)
    A           :MSTORE(pairing_y1_11_x)
    B           :MSTORE(pairing_y1_11_y)
    $ => A      :MLOAD(mulFp12BN254_c12_x)
    $ => B      :MLOAD(mulFp12BN254_c12_y)
    A           :MSTORE(pairing_y1_12_x)
    B           :MSTORE(pairing_y1_12_y)
    $ => A      :MLOAD(mulFp12BN254_c13_x)
    $ => B      :MLOAD(mulFp12BN254_c13_y)
    A           :MSTORE(pairing_y1_13_x)
    B           :MSTORE(pairing_y1_13_y)
    $ => A      :MLOAD(mulFp12BN254_c21_x)
    $ => B      :MLOAD(mulFp12BN254_c21_y)
    A           :MSTORE(pairing_y1_21_x)
    B           :MSTORE(pairing_y1_21_y)
    $ => A      :MLOAD(mulFp12BN254_c22_x)
    $ => B      :MLOAD(mulFp12BN254_c22_y)
    A           :MSTORE(pairing_y1_22_x)
    B           :MSTORE(pairing_y1_22_y)
    $ => A      :MLOAD(mulFp12BN254_c23_x)
    $ => B      :MLOAD(mulFp12BN254_c23_y)
    A           :MSTORE(pairing_y1_23_x)
    B           :MSTORE(pairing_y1_23_y)

    ; 4] y2 = m̅
    $ => A      :MLOAD(pairing_f11_x)
    $ => B      :MLOAD(pairing_f11_y)
    A           :MSTORE(pairing_y2_11_x)
    B           :MSTORE(pairing_y2_11_y)
    $ => A      :MLOAD(pairing_f12_x)
    $ => B      :MLOAD(pairing_f12_y)
    A           :MSTORE(pairing_y2_12_x)
    B           :MSTORE(pairing_y2_12_y)
    $ => A      :MLOAD(pairing_f13_x)
    $ => B      :MLOAD(pairing_f13_y)
    A           :MSTORE(pairing_y2_13_x)
    B           :MSTORE(pairing_y2_13_y)
    $ => A      :MLOAD(pairing_f21_x)
    $ => B      :MLOAD(pairing_f21_y)
    ${const.BN254_P - A}           :MSTORE(pairing_y2_21_x)
    ${const.BN254_P - B}           :MSTORE(pairing_y2_21_y)
    $ => A      :MLOAD(pairing_f22_x)
    $ => B      :MLOAD(pairing_f22_y)
    ${const.BN254_P - A}           :MSTORE(pairing_y2_22_x)
    ${const.BN254_P - B}           :MSTORE(pairing_y2_22_y)
    $ => A      :MLOAD(pairing_f23_x)
    $ => B      :MLOAD(pairing_f23_y)
    ${const.BN254_P - A}           :MSTORE(pairing_y2_23_x)
    ${const.BN254_P - B}           :MSTORE(pairing_y2_23_y)

    ; 5] y3 = (m^x²)^p²
    ; This has already been computed

    ; 6] y4 = \bar{(m^x)^p}
    $ => A      :MLOAD(pairing_mxp11_x)
    $ => B      :MLOAD(pairing_mxp11_y)
    A           :MSTORE(pairing_y4_11_x)
    B           :MSTORE(pairing_y4_11_y)
    $ => A      :MLOAD(pairing_mxp12_x)
    $ => B      :MLOAD(pairing_mxp12_y)
    A           :MSTORE(pairing_y4_12_x)
    B           :MSTORE(pairing_y4_12_y)
    $ => A      :MLOAD(pairing_mxp13_x)
    $ => B      :MLOAD(pairing_mxp13_y)
    A           :MSTORE(pairing_y4_13_x)
    B           :MSTORE(pairing_y4_13_y)
    $ => A      :MLOAD(pairing_mxp21_x)
    $ => B      :MLOAD(pairing_mxp21_y)
    ${const.BN254_P - A}           :MSTORE(pairing_y4_21_x)
    ${const.BN254_P - B}           :MSTORE(pairing_y4_21_y)
    $ => A      :MLOAD(pairing_mxp22_x)
    $ => B      :MLOAD(pairing_mxp22_y)
    ${const.BN254_P - A}           :MSTORE(pairing_y4_22_x)
    ${const.BN254_P - B}           :MSTORE(pairing_y4_22_y)
    $ => A      :MLOAD(pairing_mxp23_x)
    $ => B      :MLOAD(pairing_mxp23_y)
    ${const.BN254_P - A}           :MSTORE(pairing_y4_23_x)
    ${const.BN254_P - B}           :MSTORE(pairing_y4_23_y)

    ; 7] y5 = \bar{m^x·(m^x²)^p}
    $ => A      :MLOAD(pairing_mx11_x)
    $ => B      :MLOAD(pairing_mx11_y)
    A           :MSTORE(mulFp12BN254_a11_x)
    B           :MSTORE(mulFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_mx12_x)
    $ => B      :MLOAD(pairing_mx12_y)
    A           :MSTORE(mulFp12BN254_a12_x)
    B           :MSTORE(mulFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_mx13_x)
    $ => B      :MLOAD(pairing_mx13_y)
    A           :MSTORE(mulFp12BN254_a13_x)
    B           :MSTORE(mulFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_mx21_x)
    $ => B      :MLOAD(pairing_mx21_y)
    A           :MSTORE(mulFp12BN254_a21_x)
    B           :MSTORE(mulFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_mx22_x)
    $ => B      :MLOAD(pairing_mx22_y)
    A           :MSTORE(mulFp12BN254_a22_x)
    B           :MSTORE(mulFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_mx23_x)
    $ => B      :MLOAD(pairing_mx23_y)
    A           :MSTORE(mulFp12BN254_a23_x)
    B           :MSTORE(mulFp12BN254_a23_y)
    $ => A      :MLOAD(pairing_mxxp11_x)
    $ => B      :MLOAD(pairing_mxxp11_y)
    A           :MSTORE(mulFp12BN254_b11_x)
    B           :MSTORE(mulFp12BN254_b11_y)
    $ => A      :MLOAD(pairing_mxxp12_x)
    $ => B      :MLOAD(pairing_mxxp12_y)
    A           :MSTORE(mulFp12BN254_b12_x)
    B           :MSTORE(mulFp12BN254_b12_y)
    $ => A      :MLOAD(pairing_mxxp13_x)
    $ => B      :MLOAD(pairing_mxxp13_y)
    A           :MSTORE(mulFp12BN254_b13_x)
    B           :MSTORE(mulFp12BN254_b13_y)
    $ => A      :MLOAD(pairing_mxxp21_x)
    $ => B      :MLOAD(pairing_mxxp21_y)
    A           :MSTORE(mulFp12BN254_b21_x)
    B           :MSTORE(mulFp12BN254_b21_y)
    $ => A      :MLOAD(pairing_mxxp22_x)
    $ => B      :MLOAD(pairing_mxxp22_y)
    A           :MSTORE(mulFp12BN254_b22_x)
    B           :MSTORE(mulFp12BN254_b22_y)
    $ => A      :MLOAD(pairing_mxxp23_x)
    $ => B      :MLOAD(pairing_mxxp23_y)
    A           :MSTORE(mulFp12BN254_b23_x)
    B           :MSTORE(mulFp12BN254_b23_y)
                :CALL(mulFp12BN254)
    $ => A      :MLOAD(mulFp12BN254_c11_x)
    $ => B      :MLOAD(mulFp12BN254_c11_y)
    A           :MSTORE(pairing_y5_11_x)
    B           :MSTORE(pairing_y5_11_y)
    $ => A      :MLOAD(mulFp12BN254_c12_x)
    $ => B      :MLOAD(mulFp12BN254_c12_y)
    A           :MSTORE(pairing_y5_12_x)
    B           :MSTORE(pairing_y5_12_y)
    $ => A      :MLOAD(mulFp12BN254_c13_x)
    $ => B      :MLOAD(mulFp12BN254_c13_y)
    A           :MSTORE(pairing_y5_13_x)
    B           :MSTORE(pairing_y5_13_y)
    $ => A      :MLOAD(mulFp12BN254_c21_x)
    $ => B      :MLOAD(mulFp12BN254_c21_y)
    ${const.BN254_P - A}           :MSTORE(pairing_y5_21_x)
    ${const.BN254_P - B}           :MSTORE(pairing_y5_21_y)
    $ => A      :MLOAD(mulFp12BN254_c22_x)
    $ => B      :MLOAD(mulFp12BN254_c22_y)
    ${const.BN254_P - A}           :MSTORE(pairing_y5_22_x)
    ${const.BN254_P - B}           :MSTORE(pairing_y5_22_y)
    $ => A      :MLOAD(mulFp12BN254_c23_x)
    $ => B      :MLOAD(mulFp12BN254_c23_y)
    ${const.BN254_P - A}           :MSTORE(pairing_y5_23_x)
    ${const.BN254_P - B}           :MSTORE(pairing_y5_23_y)

    ; 8] y6 = \bar{m^x²}
    $ => A      :MLOAD(pairing_mxx11_x)
    $ => B      :MLOAD(pairing_mxx11_y)
    A           :MSTORE(pairing_y6_11_x)
    B           :MSTORE(pairing_y6_11_y)
    $ => A      :MLOAD(pairing_mxx12_x)
    $ => B      :MLOAD(pairing_mxx12_y)
    A           :MSTORE(pairing_y6_12_x)
    B           :MSTORE(pairing_y6_12_y)
    $ => A      :MLOAD(pairing_mxx13_x)
    $ => B      :MLOAD(pairing_mxx13_y)
    A           :MSTORE(pairing_y6_13_x)
    B           :MSTORE(pairing_y6_13_y)
    $ => A      :MLOAD(pairing_mxx21_x)
    $ => B      :MLOAD(pairing_mxx21_y)
    ${const.BN254_P - A}           :MSTORE(pairing_y6_21_x)
    ${const.BN254_P - B}           :MSTORE(pairing_y6_21_y)
    $ => A      :MLOAD(pairing_mxx22_x)
    $ => B      :MLOAD(pairing_mxx22_y)
    ${const.BN254_P - A}           :MSTORE(pairing_y6_22_x)
    ${const.BN254_P - B}           :MSTORE(pairing_y6_22_y)
    $ => A      :MLOAD(pairing_mxx23_x)
    $ => B      :MLOAD(pairing_mxx23_y)
    ${const.BN254_P - A}           :MSTORE(pairing_y6_23_x)
    ${const.BN254_P - B}           :MSTORE(pairing_y6_23_y)

    ; 9] y7 = \bar{m^x³·(m^x³)^p}
    $ => A      :MLOAD(pairing_mxxx11_x)
    $ => B      :MLOAD(pairing_mxxx11_y)
    A           :MSTORE(mulFp12BN254_a11_x)
    B           :MSTORE(mulFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_mxxx12_x)
    $ => B      :MLOAD(pairing_mxxx12_y)
    A           :MSTORE(mulFp12BN254_a12_x)
    B           :MSTORE(mulFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_mxxx13_x)
    $ => B      :MLOAD(pairing_mxxx13_y)
    A           :MSTORE(mulFp12BN254_a13_x)
    B           :MSTORE(mulFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_mxxx21_x)
    $ => B      :MLOAD(pairing_mxxx21_y)
    A           :MSTORE(mulFp12BN254_a21_x)
    B           :MSTORE(mulFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_mxxx22_x)
    $ => B      :MLOAD(pairing_mxxx22_y)
    A           :MSTORE(mulFp12BN254_a22_x)
    B           :MSTORE(mulFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_mxxx23_x)
    $ => B      :MLOAD(pairing_mxxx23_y)
    A           :MSTORE(mulFp12BN254_a23_x)
    B           :MSTORE(mulFp12BN254_a23_y)
    $ => A      :MLOAD(pairing_mxxxp11_x)
    $ => B      :MLOAD(pairing_mxxxp11_y)
    A           :MSTORE(mulFp12BN254_b11_x)
    B           :MSTORE(mulFp12BN254_b11_y)
    $ => A      :MLOAD(pairing_mxxxp12_x)
    $ => B      :MLOAD(pairing_mxxxp12_y)
    A           :MSTORE(mulFp12BN254_b12_x)
    B           :MSTORE(mulFp12BN254_b12_y)
    $ => A      :MLOAD(pairing_mxxxp13_x)
    $ => B      :MLOAD(pairing_mxxxp13_y)
    A           :MSTORE(mulFp12BN254_b13_x)
    B           :MSTORE(mulFp12BN254_b13_y)
    $ => A      :MLOAD(pairing_mxxxp21_x)
    $ => B      :MLOAD(pairing_mxxxp21_y)
    A           :MSTORE(mulFp12BN254_b21_x)
    B           :MSTORE(mulFp12BN254_b21_y)
    $ => A      :MLOAD(pairing_mxxxp22_x)
    $ => B      :MLOAD(pairing_mxxxp22_y)
    A           :MSTORE(mulFp12BN254_b22_x)
    B           :MSTORE(mulFp12BN254_b22_y)
    $ => A      :MLOAD(pairing_mxxxp23_x)
    $ => B      :MLOAD(pairing_mxxxp23_y)
    A           :MSTORE(mulFp12BN254_b23_x)
    B           :MSTORE(mulFp12BN254_b23_y)
                :CALL(mulFp12BN254)
    $ => A      :MLOAD(mulFp12BN254_c11_x)
    $ => B      :MLOAD(mulFp12BN254_c11_y)
    A           :MSTORE(pairing_y7_11_x)
    B           :MSTORE(pairing_y7_11_y)
    $ => A      :MLOAD(mulFp12BN254_c12_x)
    $ => B      :MLOAD(mulFp12BN254_c12_y)
    A           :MSTORE(pairing_y7_12_x)
    B           :MSTORE(pairing_y7_12_y)
    $ => A      :MLOAD(mulFp12BN254_c13_x)
    $ => B      :MLOAD(mulFp12BN254_c13_y)
    A           :MSTORE(pairing_y7_13_x)
    B           :MSTORE(pairing_y7_13_y)
    $ => A      :MLOAD(mulFp12BN254_c21_x)
    $ => B      :MLOAD(mulFp12BN254_c21_y)
    ${const.BN254_P - A}           :MSTORE(pairing_y7_21_x)
    ${const.BN254_P - B}           :MSTORE(pairing_y7_21_y)
    $ => A      :MLOAD(mulFp12BN254_c22_x)
    $ => B      :MLOAD(mulFp12BN254_c22_y)
    ${const.BN254_P - A}           :MSTORE(pairing_y7_22_x)
    ${const.BN254_P - B}           :MSTORE(pairing_y7_22_y)
    $ => A      :MLOAD(mulFp12BN254_c23_x)
    $ => B      :MLOAD(mulFp12BN254_c23_y)
    ${const.BN254_P - A}           :MSTORE(pairing_y7_23_x)
    ${const.BN254_P - B}           :MSTORE(pairing_y7_23_y)


    ; 10] Compute y1·y2²·y3⁶·y4¹²·y5¹⁸·y6³⁰·y7³⁶ as follows

    ;   10.1] T11 = y7²·y5·y6
    $ => A      :MLOAD(pairing_y7_11_x)
    $ => B      :MLOAD(pairing_y7_11_y)
    A           :MSTORE(squareFp12BN254_a11_x)
    B           :MSTORE(squareFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_y7_12_x)
    $ => B      :MLOAD(pairing_y7_12_y)
    A           :MSTORE(squareFp12BN254_a12_x)
    B           :MSTORE(squareFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_y7_13_x)
    $ => B      :MLOAD(pairing_y7_13_y)
    A           :MSTORE(squareFp12BN254_a13_x)
    B           :MSTORE(squareFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_y7_21_x)
    $ => B      :MLOAD(pairing_y7_21_y)
    A           :MSTORE(squareFp12BN254_a21_x)
    B           :MSTORE(squareFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_y7_22_x)
    $ => B      :MLOAD(pairing_y7_22_y)
    A           :MSTORE(squareFp12BN254_a22_x)
    B           :MSTORE(squareFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_y7_23_x)
    $ => B      :MLOAD(pairing_y7_23_y)
    A           :MSTORE(squareFp12BN254_a23_x)
    B           :MSTORE(squareFp12BN254_a23_y)
                :CALL(squareFp12BN254)
    $ => A      :MLOAD(squareFp12BN254_c11_x)
    $ => B      :MLOAD(squareFp12BN254_c11_y)
    A           :MSTORE(mulFp12BN254_a11_x)
    B           :MSTORE(mulFp12BN254_a11_y)
    $ => A      :MLOAD(squareFp12BN254_c12_x)
    $ => B      :MLOAD(squareFp12BN254_c12_y)
    A           :MSTORE(mulFp12BN254_a12_x)
    B           :MSTORE(mulFp12BN254_a12_y)
    $ => A      :MLOAD(squareFp12BN254_c13_x)
    $ => B      :MLOAD(squareFp12BN254_c13_y)
    A           :MSTORE(mulFp12BN254_a13_x)
    B           :MSTORE(mulFp12BN254_a13_y)
    $ => A      :MLOAD(squareFp12BN254_c21_x)
    $ => B      :MLOAD(squareFp12BN254_c21_y)
    A           :MSTORE(mulFp12BN254_a21_x)
    B           :MSTORE(mulFp12BN254_a21_y)
    $ => A      :MLOAD(squareFp12BN254_c22_x)
    $ => B      :MLOAD(squareFp12BN254_c22_y)
    A           :MSTORE(mulFp12BN254_a22_x)
    B           :MSTORE(mulFp12BN254_a22_y)
    $ => A      :MLOAD(squareFp12BN254_c23_x)
    $ => B      :MLOAD(squareFp12BN254_c23_y)
    A           :MSTORE(mulFp12BN254_a23_x)
    B           :MSTORE(mulFp12BN254_a23_y)
    $ => A      :MLOAD(pairing_y5_11_x)
    $ => B      :MLOAD(pairing_y5_11_y)
    A           :MSTORE(mulFp12BN254_b11_x)
    B           :MSTORE(mulFp12BN254_b11_y)
    $ => A      :MLOAD(pairing_y5_12_x)
    $ => B      :MLOAD(pairing_y5_12_y)
    A           :MSTORE(mulFp12BN254_b12_x)
    B           :MSTORE(mulFp12BN254_b12_y)
    $ => A      :MLOAD(pairing_y5_13_x)
    $ => B      :MLOAD(pairing_y5_13_y)
    A           :MSTORE(mulFp12BN254_b13_x)
    B           :MSTORE(mulFp12BN254_b13_y)
    $ => A      :MLOAD(pairing_y5_21_x)
    $ => B      :MLOAD(pairing_y5_21_y)
    A           :MSTORE(mulFp12BN254_b21_x)
    B           :MSTORE(mulFp12BN254_b21_y)
    $ => A      :MLOAD(pairing_y5_22_x)
    $ => B      :MLOAD(pairing_y5_22_y)
    A           :MSTORE(mulFp12BN254_b22_x)
    B           :MSTORE(mulFp12BN254_b22_y)
    $ => A      :MLOAD(pairing_y5_23_x)
    $ => B      :MLOAD(pairing_y5_23_y)
    A           :MSTORE(mulFp12BN254_b23_x)
    B           :MSTORE(mulFp12BN254_b23_y)
                :CALL(mulFp12BN254)
    $ => A      :MLOAD(mulFp12BN254_c11_x)
    $ => B      :MLOAD(mulFp12BN254_c11_y)
    A           :MSTORE(mulFp12BN254_a11_x)
    B           :MSTORE(mulFp12BN254_a11_y)
    $ => A      :MLOAD(mulFp12BN254_c12_x)
    $ => B      :MLOAD(mulFp12BN254_c12_y)
    A           :MSTORE(mulFp12BN254_a12_x)
    B           :MSTORE(mulFp12BN254_a12_y)
    $ => A      :MLOAD(mulFp12BN254_c13_x)
    $ => B      :MLOAD(mulFp12BN254_c13_y)
    A           :MSTORE(mulFp12BN254_a13_x)
    B           :MSTORE(mulFp12BN254_a13_y)
    $ => A      :MLOAD(mulFp12BN254_c21_x)
    $ => B      :MLOAD(mulFp12BN254_c21_y)
    A           :MSTORE(mulFp12BN254_a21_x)
    B           :MSTORE(mulFp12BN254_a21_y)
    $ => A      :MLOAD(mulFp12BN254_c22_x)
    $ => B      :MLOAD(mulFp12BN254_c22_y)
    A           :MSTORE(mulFp12BN254_a22_x)
    B           :MSTORE(mulFp12BN254_a22_y)
    $ => A      :MLOAD(mulFp12BN254_c23_x)
    $ => B      :MLOAD(mulFp12BN254_c23_y)
    A           :MSTORE(mulFp12BN254_a23_x)
    B           :MSTORE(mulFp12BN254_a23_y)
    $ => A      :MLOAD(pairing_y6_11_x)
    $ => B      :MLOAD(pairing_y6_11_y)
    A           :MSTORE(mulFp12BN254_b11_x)
    B           :MSTORE(mulFp12BN254_b11_y)
    $ => A      :MLOAD(pairing_y6_12_x)
    $ => B      :MLOAD(pairing_y6_12_y)
    A           :MSTORE(mulFp12BN254_b12_x)
    B           :MSTORE(mulFp12BN254_b12_y)
    $ => A      :MLOAD(pairing_y6_13_x)
    $ => B      :MLOAD(pairing_y6_13_y)
    A           :MSTORE(mulFp12BN254_b13_x)
    B           :MSTORE(mulFp12BN254_b13_y)
    $ => A      :MLOAD(pairing_y6_21_x)
    $ => B      :MLOAD(pairing_y6_21_y)
    A           :MSTORE(mulFp12BN254_b21_x)
    B           :MSTORE(mulFp12BN254_b21_y)
    $ => A      :MLOAD(pairing_y6_22_x)
    $ => B      :MLOAD(pairing_y6_22_y)
    A           :MSTORE(mulFp12BN254_b22_x)
    B           :MSTORE(mulFp12BN254_b22_y)
    $ => A      :MLOAD(pairing_y6_23_x)
    $ => B      :MLOAD(pairing_y6_23_y)
    A           :MSTORE(mulFp12BN254_b23_x)
    B           :MSTORE(mulFp12BN254_b23_y)
                :CALL(mulFp12BN254)
    $ => A      :MLOAD(mulFp12BN254_c11_x)
    $ => B      :MLOAD(mulFp12BN254_c11_y)
    A           :MSTORE(pairing_T11_11_x)
    B           :MSTORE(pairing_T11_11_y)
    $ => A      :MLOAD(mulFp12BN254_c12_x)
    $ => B      :MLOAD(mulFp12BN254_c12_y)
    A           :MSTORE(pairing_T11_12_x)
    B           :MSTORE(pairing_T11_12_y)
    $ => A      :MLOAD(mulFp12BN254_c13_x)
    $ => B      :MLOAD(mulFp12BN254_c13_y)
    A           :MSTORE(pairing_T11_13_x)
    B           :MSTORE(pairing_T11_13_y)
    $ => A      :MLOAD(mulFp12BN254_c21_x)
    $ => B      :MLOAD(mulFp12BN254_c21_y)
    A           :MSTORE(pairing_T11_21_x)
    B           :MSTORE(pairing_T11_21_y)
    $ => A      :MLOAD(mulFp12BN254_c22_x)
    $ => B      :MLOAD(mulFp12BN254_c22_y)
    A           :MSTORE(pairing_T11_22_x)
    B           :MSTORE(pairing_T11_22_y)
    $ => A      :MLOAD(mulFp12BN254_c23_x)
    $ => B      :MLOAD(mulFp12BN254_c23_y)
    A           :MSTORE(pairing_T11_23_x)
    B           :MSTORE(pairing_T11_23_y)

    ;   10.2] T21 = T11·y4·y6
    $ => A      :MLOAD(pairing_T11_11_x)
    $ => B      :MLOAD(pairing_T11_11_y)
    A           :MSTORE(mulFp12BN254_a11_x)
    B           :MSTORE(mulFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_T11_12_x)
    $ => B      :MLOAD(pairing_T11_12_y)
    A           :MSTORE(mulFp12BN254_a12_x)
    B           :MSTORE(mulFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_T11_13_x)
    $ => B      :MLOAD(pairing_T11_13_y)
    A           :MSTORE(mulFp12BN254_a13_x)
    B           :MSTORE(mulFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_T11_21_x)
    $ => B      :MLOAD(pairing_T11_21_y)
    A           :MSTORE(mulFp12BN254_a21_x)
    B           :MSTORE(mulFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_T11_22_x)
    $ => B      :MLOAD(pairing_T11_22_y)
    A           :MSTORE(mulFp12BN254_a22_x)
    B           :MSTORE(mulFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_T11_23_x)
    $ => B      :MLOAD(pairing_T11_23_y)
    A           :MSTORE(mulFp12BN254_a23_x)
    B           :MSTORE(mulFp12BN254_a23_y)
    $ => A      :MLOAD(pairing_y4_11_x)
    $ => B      :MLOAD(pairing_y4_11_y)
    A           :MSTORE(mulFp12BN254_b11_x)
    B           :MSTORE(mulFp12BN254_b11_y)
    $ => A      :MLOAD(pairing_y4_12_x)
    $ => B      :MLOAD(pairing_y4_12_y)
    A           :MSTORE(mulFp12BN254_b12_x)
    B           :MSTORE(mulFp12BN254_b12_y)
    $ => A      :MLOAD(pairing_y4_13_x)
    $ => B      :MLOAD(pairing_y4_13_y)
    A           :MSTORE(mulFp12BN254_b13_x)
    B           :MSTORE(mulFp12BN254_b13_y)
    $ => A      :MLOAD(pairing_y4_21_x)
    $ => B      :MLOAD(pairing_y4_21_y)
    A           :MSTORE(mulFp12BN254_b21_x)
    B           :MSTORE(mulFp12BN254_b21_y)
    $ => A      :MLOAD(pairing_y4_22_x)
    $ => B      :MLOAD(pairing_y4_22_y)
    A           :MSTORE(mulFp12BN254_b22_x)
    B           :MSTORE(mulFp12BN254_b22_y)
    $ => A      :MLOAD(pairing_y4_23_x)
    $ => B      :MLOAD(pairing_y4_23_y)
    A           :MSTORE(mulFp12BN254_b23_x)
    B           :MSTORE(mulFp12BN254_b23_y)
                :CALL(mulFp12BN254)
    $ => A      :MLOAD(mulFp12BN254_c11_x)
    $ => B      :MLOAD(mulFp12BN254_c11_y)
    A           :MSTORE(mulFp12BN254_a11_x)
    B           :MSTORE(mulFp12BN254_a11_y)
    $ => A      :MLOAD(mulFp12BN254_c12_x)
    $ => B      :MLOAD(mulFp12BN254_c12_y)
    A           :MSTORE(mulFp12BN254_a12_x)
    B           :MSTORE(mulFp12BN254_a12_y)
    $ => A      :MLOAD(mulFp12BN254_c13_x)
    $ => B      :MLOAD(mulFp12BN254_c13_y)
    A           :MSTORE(mulFp12BN254_a13_x)
    B           :MSTORE(mulFp12BN254_a13_y)
    $ => A      :MLOAD(mulFp12BN254_c21_x)
    $ => B      :MLOAD(mulFp12BN254_c21_y)
    A           :MSTORE(mulFp12BN254_a21_x)
    B           :MSTORE(mulFp12BN254_a21_y)
    $ => A      :MLOAD(mulFp12BN254_c22_x)
    $ => B      :MLOAD(mulFp12BN254_c22_y)
    A           :MSTORE(mulFp12BN254_a22_x)
    B           :MSTORE(mulFp12BN254_a22_y)
    $ => A      :MLOAD(mulFp12BN254_c23_x)
    $ => B      :MLOAD(mulFp12BN254_c23_y)
    A           :MSTORE(mulFp12BN254_a23_x)
    B           :MSTORE(mulFp12BN254_a23_y)
    $ => A      :MLOAD(pairing_y6_11_x)
    $ => B      :MLOAD(pairing_y6_11_y)
    A           :MSTORE(mulFp12BN254_b11_x)
    B           :MSTORE(mulFp12BN254_b11_y)
    $ => A      :MLOAD(pairing_y6_12_x)
    $ => B      :MLOAD(pairing_y6_12_y)
    A           :MSTORE(mulFp12BN254_b12_x)
    B           :MSTORE(mulFp12BN254_b12_y)
    $ => A      :MLOAD(pairing_y6_13_x)
    $ => B      :MLOAD(pairing_y6_13_y)
    A           :MSTORE(mulFp12BN254_b13_x)
    B           :MSTORE(mulFp12BN254_b13_y)
    $ => A      :MLOAD(pairing_y6_21_x)
    $ => B      :MLOAD(pairing_y6_21_y)
    A           :MSTORE(mulFp12BN254_b21_x)
    B           :MSTORE(mulFp12BN254_b21_y)
    $ => A      :MLOAD(pairing_y6_22_x)
    $ => B      :MLOAD(pairing_y6_22_y)
    A           :MSTORE(mulFp12BN254_b22_x)
    B           :MSTORE(mulFp12BN254_b22_y)
    $ => A      :MLOAD(pairing_y6_23_x)
    $ => B      :MLOAD(pairing_y6_23_y)
    A           :MSTORE(mulFp12BN254_b23_x)
    B           :MSTORE(mulFp12BN254_b23_y)
                :CALL(mulFp12BN254)
    $ => A      :MLOAD(mulFp12BN254_c11_x)
    $ => B      :MLOAD(mulFp12BN254_c11_y)
    A           :MSTORE(pairing_T21_11_x)
    B           :MSTORE(pairing_T21_11_y)
    $ => A      :MLOAD(mulFp12BN254_c12_x)
    $ => B      :MLOAD(mulFp12BN254_c12_y)
    A           :MSTORE(pairing_T21_12_x)
    B           :MSTORE(pairing_T21_12_y)
    $ => A      :MLOAD(mulFp12BN254_c13_x)
    $ => B      :MLOAD(mulFp12BN254_c13_y)
    A           :MSTORE(pairing_T21_13_x)
    B           :MSTORE(pairing_T21_13_y)
    $ => A      :MLOAD(mulFp12BN254_c21_x)
    $ => B      :MLOAD(mulFp12BN254_c21_y)
    A           :MSTORE(pairing_T21_21_x)
    B           :MSTORE(pairing_T21_21_y)
    $ => A      :MLOAD(mulFp12BN254_c22_x)
    $ => B      :MLOAD(mulFp12BN254_c22_y)
    A           :MSTORE(pairing_T21_22_x)
    B           :MSTORE(pairing_T21_22_y)
    $ => A      :MLOAD(mulFp12BN254_c23_x)
    $ => B      :MLOAD(mulFp12BN254_c23_y)
    A           :MSTORE(pairing_T21_23_x)
    B           :MSTORE(pairing_T21_23_y)

    ;   10.3] T12 = T11·y3
    $ => A      :MLOAD(pairing_T11_11_x)
    $ => B      :MLOAD(pairing_T11_11_y)
    A           :MSTORE(mulFp12BN254_a11_x)
    B           :MSTORE(mulFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_T11_12_x)
    $ => B      :MLOAD(pairing_T11_12_y)
    A           :MSTORE(mulFp12BN254_a12_x)
    B           :MSTORE(mulFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_T11_13_x)
    $ => B      :MLOAD(pairing_T11_13_y)
    A           :MSTORE(mulFp12BN254_a13_x)
    B           :MSTORE(mulFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_T11_21_x)
    $ => B      :MLOAD(pairing_T11_21_y)
    A           :MSTORE(mulFp12BN254_a21_x)
    B           :MSTORE(mulFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_T11_22_x)
    $ => B      :MLOAD(pairing_T11_22_y)
    A           :MSTORE(mulFp12BN254_a22_x)
    B           :MSTORE(mulFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_T11_23_x)
    $ => B      :MLOAD(pairing_T11_23_y)
    A           :MSTORE(mulFp12BN254_a23_x)
    B           :MSTORE(mulFp12BN254_a23_y)
    $ => A      :MLOAD(pairing_mxxpp11_x)
    $ => B      :MLOAD(pairing_mxxpp11_y)
    A           :MSTORE(mulFp12BN254_b11_x)
    B           :MSTORE(mulFp12BN254_b11_y)
    $ => A      :MLOAD(pairing_mxxpp12_x)
    $ => B      :MLOAD(pairing_mxxpp12_y)
    A           :MSTORE(mulFp12BN254_b12_x)
    B           :MSTORE(mulFp12BN254_b12_y)
    $ => A      :MLOAD(pairing_mxxpp13_x)
    $ => B      :MLOAD(pairing_mxxpp13_y)
    A           :MSTORE(mulFp12BN254_b13_x)
    B           :MSTORE(mulFp12BN254_b13_y)
    $ => A      :MLOAD(pairing_mxxpp21_x)
    $ => B      :MLOAD(pairing_mxxpp21_y)
    A           :MSTORE(mulFp12BN254_b21_x)
    B           :MSTORE(mulFp12BN254_b21_y)
    $ => A      :MLOAD(pairing_mxxpp22_x)
    $ => B      :MLOAD(pairing_mxxpp22_y)
    A           :MSTORE(mulFp12BN254_b22_x)
    B           :MSTORE(mulFp12BN254_b22_y)
    $ => A      :MLOAD(pairing_mxxpp23_x)
    $ => B      :MLOAD(pairing_mxxpp23_y)
    A           :MSTORE(mulFp12BN254_b23_x)
    B           :MSTORE(mulFp12BN254_b23_y)
                :CALL(mulFp12BN254)
    $ => A      :MLOAD(mulFp12BN254_c11_x)
    $ => B      :MLOAD(mulFp12BN254_c11_y)
    A           :MSTORE(pairing_T12_11_x)
    B           :MSTORE(pairing_T12_11_y)
    $ => A      :MLOAD(mulFp12BN254_c12_x)
    $ => B      :MLOAD(mulFp12BN254_c12_y)
    A           :MSTORE(pairing_T12_12_x)
    B           :MSTORE(pairing_T12_12_y)
    $ => A      :MLOAD(mulFp12BN254_c13_x)
    $ => B      :MLOAD(mulFp12BN254_c13_y)
    A           :MSTORE(pairing_T12_13_x)
    B           :MSTORE(pairing_T12_13_y)
    $ => A      :MLOAD(mulFp12BN254_c21_x)
    $ => B      :MLOAD(mulFp12BN254_c21_y)
    A           :MSTORE(pairing_T12_21_x)
    B           :MSTORE(pairing_T12_21_y)
    $ => A      :MLOAD(mulFp12BN254_c22_x)
    $ => B      :MLOAD(mulFp12BN254_c22_y)
    A           :MSTORE(pairing_T12_22_x)
    B           :MSTORE(pairing_T12_22_y)
    $ => A      :MLOAD(mulFp12BN254_c23_x)
    $ => B      :MLOAD(mulFp12BN254_c23_y)
    A           :MSTORE(pairing_T12_23_x)
    B           :MSTORE(pairing_T12_23_y)

    ;   10.4] T22 = T21²·T12
    $ => A      :MLOAD(pairing_T21_11_x)
    $ => B      :MLOAD(pairing_T21_11_y)
    A           :MSTORE(squareFp12BN254_a11_x)
    B           :MSTORE(squareFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_T21_12_x)
    $ => B      :MLOAD(pairing_T21_12_y)
    A           :MSTORE(squareFp12BN254_a12_x)
    B           :MSTORE(squareFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_T21_13_x)
    $ => B      :MLOAD(pairing_T21_13_y)
    A           :MSTORE(squareFp12BN254_a13_x)
    B           :MSTORE(squareFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_T21_21_x)
    $ => B      :MLOAD(pairing_T21_21_y)
    A           :MSTORE(squareFp12BN254_a21_x)
    B           :MSTORE(squareFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_T21_22_x)
    $ => B      :MLOAD(pairing_T21_22_y)
    A           :MSTORE(squareFp12BN254_a22_x)
    B           :MSTORE(squareFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_T21_23_x)
    $ => B      :MLOAD(pairing_T21_23_y)
    A           :MSTORE(squareFp12BN254_a23_x)
    B           :MSTORE(squareFp12BN254_a23_y)
                :CALL(squareFp12BN254)
    $ => A      :MLOAD(squareFp12BN254_c11_x)
    $ => B      :MLOAD(squareFp12BN254_c11_y)
    A           :MSTORE(mulFp12BN254_a11_x)
    B           :MSTORE(mulFp12BN254_a11_y)
    $ => A      :MLOAD(squareFp12BN254_c12_x)
    $ => B      :MLOAD(squareFp12BN254_c12_y)
    A           :MSTORE(mulFp12BN254_a12_x)
    B           :MSTORE(mulFp12BN254_a12_y)
    $ => A      :MLOAD(squareFp12BN254_c13_x)
    $ => B      :MLOAD(squareFp12BN254_c13_y)
    A           :MSTORE(mulFp12BN254_a13_x)
    B           :MSTORE(mulFp12BN254_a13_y)
    $ => A      :MLOAD(squareFp12BN254_c21_x)
    $ => B      :MLOAD(squareFp12BN254_c21_y)
    A           :MSTORE(mulFp12BN254_a21_x)
    B           :MSTORE(mulFp12BN254_a21_y)
    $ => A      :MLOAD(squareFp12BN254_c22_x)
    $ => B      :MLOAD(squareFp12BN254_c22_y)
    A           :MSTORE(mulFp12BN254_a22_x)
    B           :MSTORE(mulFp12BN254_a22_y)
    $ => A      :MLOAD(squareFp12BN254_c23_x)
    $ => B      :MLOAD(squareFp12BN254_c23_y)
    A           :MSTORE(mulFp12BN254_a23_x)
    B           :MSTORE(mulFp12BN254_a23_y)
    $ => A      :MLOAD(pairing_T12_11_x)
    $ => B      :MLOAD(pairing_T12_11_y)
    A           :MSTORE(mulFp12BN254_b11_x)
    B           :MSTORE(mulFp12BN254_b11_y)
    $ => A      :MLOAD(pairing_T12_12_x)
    $ => B      :MLOAD(pairing_T12_12_y)
    A           :MSTORE(mulFp12BN254_b12_x)
    B           :MSTORE(mulFp12BN254_b12_y)
    $ => A      :MLOAD(pairing_T12_13_x)
    $ => B      :MLOAD(pairing_T12_13_y)
    A           :MSTORE(mulFp12BN254_b13_x)
    B           :MSTORE(mulFp12BN254_b13_y)
    $ => A      :MLOAD(pairing_T12_21_x)
    $ => B      :MLOAD(pairing_T12_21_y)
    A           :MSTORE(mulFp12BN254_b21_x)
    B           :MSTORE(mulFp12BN254_b21_y)
    $ => A      :MLOAD(pairing_T12_22_x)
    $ => B      :MLOAD(pairing_T12_22_y)
    A           :MSTORE(mulFp12BN254_b22_x)
    B           :MSTORE(mulFp12BN254_b22_y)
    $ => A      :MLOAD(pairing_T12_23_x)
    $ => B      :MLOAD(pairing_T12_23_y)
    A           :MSTORE(mulFp12BN254_b23_x)
    B           :MSTORE(mulFp12BN254_b23_y)
                :CALL(mulFp12BN254)

    ;   10.5] T23 = T22²
    $ => A      :MLOAD(mulFp12BN254_c11_x)
    $ => B      :MLOAD(mulFp12BN254_c11_y)
    A           :MSTORE(squareFp12BN254_a11_x)
    B           :MSTORE(squareFp12BN254_a11_y)
    $ => A      :MLOAD(mulFp12BN254_c12_x)
    $ => B      :MLOAD(mulFp12BN254_c12_y)
    A           :MSTORE(squareFp12BN254_a12_x)
    B           :MSTORE(squareFp12BN254_a12_y)
    $ => A      :MLOAD(mulFp12BN254_c13_x)
    $ => B      :MLOAD(mulFp12BN254_c13_y)
    A           :MSTORE(squareFp12BN254_a13_x)
    B           :MSTORE(squareFp12BN254_a13_y)
    $ => A      :MLOAD(mulFp12BN254_c21_x)
    $ => B      :MLOAD(mulFp12BN254_c21_y)
    A           :MSTORE(squareFp12BN254_a21_x)
    B           :MSTORE(squareFp12BN254_a21_y)
    $ => A      :MLOAD(mulFp12BN254_c22_x)
    $ => B      :MLOAD(mulFp12BN254_c22_y)
    A           :MSTORE(squareFp12BN254_a22_x)
    B           :MSTORE(squareFp12BN254_a22_y)
    $ => A      :MLOAD(mulFp12BN254_c23_x)
    $ => B      :MLOAD(mulFp12BN254_c23_y)
    A           :MSTORE(squareFp12BN254_a23_x)
    B           :MSTORE(squareFp12BN254_a23_y)
                :CALL(squareFp12BN254)
    $ => A      :MLOAD(squareFp12BN254_c11_x)
    $ => B      :MLOAD(squareFp12BN254_c11_y)
    A           :MSTORE(pairing_T23_11_x)
    B           :MSTORE(pairing_T23_11_y)
    $ => A      :MLOAD(squareFp12BN254_c12_x)
    $ => B      :MLOAD(squareFp12BN254_c12_y)
    A           :MSTORE(pairing_T23_12_x)
    B           :MSTORE(pairing_T23_12_y)
    $ => A      :MLOAD(squareFp12BN254_c13_x)
    $ => B      :MLOAD(squareFp12BN254_c13_y)
    A           :MSTORE(pairing_T23_13_x)
    B           :MSTORE(pairing_T23_13_y)
    $ => A      :MLOAD(squareFp12BN254_c21_x)
    $ => B      :MLOAD(squareFp12BN254_c21_y)
    A           :MSTORE(pairing_T23_21_x)
    B           :MSTORE(pairing_T23_21_y)
    $ => A      :MLOAD(squareFp12BN254_c22_x)
    $ => B      :MLOAD(squareFp12BN254_c22_y)
    A           :MSTORE(pairing_T23_22_x)
    B           :MSTORE(pairing_T23_22_y)
    $ => A      :MLOAD(squareFp12BN254_c23_x)
    $ => B      :MLOAD(squareFp12BN254_c23_y)
    A           :MSTORE(pairing_T23_23_x)
    B           :MSTORE(pairing_T23_23_y)

    ;   10.6] T24 = T23·y1
    $ => A      :MLOAD(pairing_T23_11_x)
    $ => B      :MLOAD(pairing_T23_11_y)
    A           :MSTORE(mulFp12BN254_a11_x)
    B           :MSTORE(mulFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_T23_12_x)
    $ => B      :MLOAD(pairing_T23_12_y)
    A           :MSTORE(mulFp12BN254_a12_x)
    B           :MSTORE(mulFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_T23_13_x)
    $ => B      :MLOAD(pairing_T23_13_y)
    A           :MSTORE(mulFp12BN254_a13_x)
    B           :MSTORE(mulFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_T23_21_x)
    $ => B      :MLOAD(pairing_T23_21_y)
    A           :MSTORE(mulFp12BN254_a21_x)
    B           :MSTORE(mulFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_T23_22_x)
    $ => B      :MLOAD(pairing_T23_22_y)
    A           :MSTORE(mulFp12BN254_a22_x)
    B           :MSTORE(mulFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_T23_23_x)
    $ => B      :MLOAD(pairing_T23_23_y)
    A           :MSTORE(mulFp12BN254_a23_x)
    B           :MSTORE(mulFp12BN254_a23_y)
    $ => A      :MLOAD(pairing_y1_11_x)
    $ => B      :MLOAD(pairing_y1_11_y)
    A           :MSTORE(mulFp12BN254_b11_x)
    B           :MSTORE(mulFp12BN254_b11_y)
    $ => A      :MLOAD(pairing_y1_12_x)
    $ => B      :MLOAD(pairing_y1_12_y)
    A           :MSTORE(mulFp12BN254_b12_x)
    B           :MSTORE(mulFp12BN254_b12_y)
    $ => A      :MLOAD(pairing_y1_13_x)
    $ => B      :MLOAD(pairing_y1_13_y)
    A           :MSTORE(mulFp12BN254_b13_x)
    B           :MSTORE(mulFp12BN254_b13_y)
    $ => A      :MLOAD(pairing_y1_21_x)
    $ => B      :MLOAD(pairing_y1_21_y)
    A           :MSTORE(mulFp12BN254_b21_x)
    B           :MSTORE(mulFp12BN254_b21_y)
    $ => A      :MLOAD(pairing_y1_22_x)
    $ => B      :MLOAD(pairing_y1_22_y)
    A           :MSTORE(mulFp12BN254_b22_x)
    B           :MSTORE(mulFp12BN254_b22_y)
    $ => A      :MLOAD(pairing_y1_23_x)
    $ => B      :MLOAD(pairing_y1_23_y)
    A           :MSTORE(mulFp12BN254_b23_x)
    B           :MSTORE(mulFp12BN254_b23_y)
                :CALL(mulFp12BN254)
    $ => A      :MLOAD(mulFp12BN254_c11_x)
    $ => B      :MLOAD(mulFp12BN254_c11_y)
    A           :MSTORE(pairing_T24_11_x)
    B           :MSTORE(pairing_T24_11_y)
    $ => A      :MLOAD(mulFp12BN254_c12_x)
    $ => B      :MLOAD(mulFp12BN254_c12_y)
    A           :MSTORE(pairing_T24_12_x)
    B           :MSTORE(pairing_T24_12_y)
    $ => A      :MLOAD(mulFp12BN254_c13_x)
    $ => B      :MLOAD(mulFp12BN254_c13_y)
    A           :MSTORE(pairing_T24_13_x)
    B           :MSTORE(pairing_T24_13_y)
    $ => A      :MLOAD(mulFp12BN254_c21_x)
    $ => B      :MLOAD(mulFp12BN254_c21_y)
    A           :MSTORE(pairing_T24_21_x)
    B           :MSTORE(pairing_T24_21_y)
    $ => A      :MLOAD(mulFp12BN254_c22_x)
    $ => B      :MLOAD(mulFp12BN254_c22_y)
    A           :MSTORE(pairing_T24_22_x)
    B           :MSTORE(pairing_T24_22_y)
    $ => A      :MLOAD(mulFp12BN254_c23_x)
    $ => B      :MLOAD(mulFp12BN254_c23_y)
    A           :MSTORE(pairing_T24_23_x)
    B           :MSTORE(pairing_T24_23_y)
    

    ;   10.7] T13 = T23·y2
    $ => A      :MLOAD(pairing_T23_11_x)
    $ => B      :MLOAD(pairing_T23_11_y)
    A           :MSTORE(mulFp12BN254_a11_x)
    B           :MSTORE(mulFp12BN254_a11_y)
    $ => A      :MLOAD(pairing_T23_12_x)
    $ => B      :MLOAD(pairing_T23_12_y)
    A           :MSTORE(mulFp12BN254_a12_x)
    B           :MSTORE(mulFp12BN254_a12_y)
    $ => A      :MLOAD(pairing_T23_13_x)
    $ => B      :MLOAD(pairing_T23_13_y)
    A           :MSTORE(mulFp12BN254_a13_x)
    B           :MSTORE(mulFp12BN254_a13_y)
    $ => A      :MLOAD(pairing_T23_21_x)
    $ => B      :MLOAD(pairing_T23_21_y)
    A           :MSTORE(mulFp12BN254_a21_x)
    B           :MSTORE(mulFp12BN254_a21_y)
    $ => A      :MLOAD(pairing_T23_22_x)
    $ => B      :MLOAD(pairing_T23_22_y)
    A           :MSTORE(mulFp12BN254_a22_x)
    B           :MSTORE(mulFp12BN254_a22_y)
    $ => A      :MLOAD(pairing_T23_23_x)
    $ => B      :MLOAD(pairing_T23_23_y)
    A           :MSTORE(mulFp12BN254_a23_x)
    B           :MSTORE(mulFp12BN254_a23_y)
    $ => A      :MLOAD(pairing_y2_11_x)
    $ => B      :MLOAD(pairing_y2_11_y)
    A           :MSTORE(mulFp12BN254_b11_x)
    B           :MSTORE(mulFp12BN254_b11_y)
    $ => A      :MLOAD(pairing_y2_12_x)
    $ => B      :MLOAD(pairing_y2_12_y)
    A           :MSTORE(mulFp12BN254_b12_x)
    B           :MSTORE(mulFp12BN254_b12_y)
    $ => A      :MLOAD(pairing_y2_13_x)
    $ => B      :MLOAD(pairing_y2_13_y)
    A           :MSTORE(mulFp12BN254_b13_x)
    B           :MSTORE(mulFp12BN254_b13_y)
    $ => A      :MLOAD(pairing_y2_21_x)
    $ => B      :MLOAD(pairing_y2_21_y)
    A           :MSTORE(mulFp12BN254_b21_x)
    B           :MSTORE(mulFp12BN254_b21_y)
    $ => A      :MLOAD(pairing_y2_22_x)
    $ => B      :MLOAD(pairing_y2_22_y)
    A           :MSTORE(mulFp12BN254_b22_x)
    B           :MSTORE(mulFp12BN254_b22_y)
    $ => A      :MLOAD(pairing_y2_23_x)
    $ => B      :MLOAD(pairing_y2_23_y)
    A           :MSTORE(mulFp12BN254_b23_x)
    B           :MSTORE(mulFp12BN254_b23_y)
                :CALL(mulFp12BN254)

    ;   10.8] T14 = T13²·T24
    $ => A      :MLOAD(mulFp12BN254_c11_x)
    $ => B      :MLOAD(mulFp12BN254_c11_y)
    A           :MSTORE(squareFp12BN254_a11_x)
    B           :MSTORE(squareFp12BN254_a11_y)
    $ => A      :MLOAD(mulFp12BN254_c12_x)
    $ => B      :MLOAD(mulFp12BN254_c12_y)
    A           :MSTORE(squareFp12BN254_a12_x)
    B           :MSTORE(squareFp12BN254_a12_y)
    $ => A      :MLOAD(mulFp12BN254_c13_x)
    $ => B      :MLOAD(mulFp12BN254_c13_y)
    A           :MSTORE(squareFp12BN254_a13_x)
    B           :MSTORE(squareFp12BN254_a13_y)
    $ => A      :MLOAD(mulFp12BN254_c21_x)
    $ => B      :MLOAD(mulFp12BN254_c21_y)
    A           :MSTORE(squareFp12BN254_a21_x)
    B           :MSTORE(squareFp12BN254_a21_y)
    $ => A      :MLOAD(mulFp12BN254_c22_x)
    $ => B      :MLOAD(mulFp12BN254_c22_y)
    A           :MSTORE(squareFp12BN254_a22_x)
    B           :MSTORE(squareFp12BN254_a22_y)
    $ => A      :MLOAD(mulFp12BN254_c23_x)
    $ => B      :MLOAD(mulFp12BN254_c23_y)
    A           :MSTORE(squareFp12BN254_a23_x)
    B           :MSTORE(squareFp12BN254_a23_y)
                :CALL(squareFp12BN254)
    $ => A      :MLOAD(squareFp12BN254_c11_x)
    $ => B      :MLOAD(squareFp12BN254_c11_y)
    A           :MSTORE(mulFp12BN254_a11_x)
    B           :MSTORE(mulFp12BN254_a11_y)
    $ => A      :MLOAD(squareFp12BN254_c12_x)
    $ => B      :MLOAD(squareFp12BN254_c12_y)
    A           :MSTORE(mulFp12BN254_a12_x)
    B           :MSTORE(mulFp12BN254_a12_y)
    $ => A      :MLOAD(squareFp12BN254_c13_x)
    $ => B      :MLOAD(squareFp12BN254_c13_y)
    A           :MSTORE(mulFp12BN254_a13_x)
    B           :MSTORE(mulFp12BN254_a13_y)
    $ => A      :MLOAD(squareFp12BN254_c21_x)
    $ => B      :MLOAD(squareFp12BN254_c21_y)
    A           :MSTORE(mulFp12BN254_a21_x)
    B           :MSTORE(mulFp12BN254_a21_y)
    $ => A      :MLOAD(squareFp12BN254_c22_x)
    $ => B      :MLOAD(squareFp12BN254_c22_y)
    A           :MSTORE(mulFp12BN254_a22_x)
    B           :MSTORE(mulFp12BN254_a22_y)
    $ => A      :MLOAD(squareFp12BN254_c23_x)
    $ => B      :MLOAD(squareFp12BN254_c23_y)
    A           :MSTORE(mulFp12BN254_a23_x)
    B           :MSTORE(mulFp12BN254_a23_y)
    $ => A      :MLOAD(pairing_T24_11_x)
    $ => B      :MLOAD(pairing_T24_11_y)
    A           :MSTORE(mulFp12BN254_b11_x)
    B           :MSTORE(mulFp12BN254_b11_y)
    $ => A      :MLOAD(pairing_T24_12_x)
    $ => B      :MLOAD(pairing_T24_12_y)
    A           :MSTORE(mulFp12BN254_b12_x)
    B           :MSTORE(mulFp12BN254_b12_y)
    $ => A      :MLOAD(pairing_T24_13_x)
    $ => B      :MLOAD(pairing_T24_13_y)
    A           :MSTORE(mulFp12BN254_b13_x)
    B           :MSTORE(mulFp12BN254_b13_y)
    $ => A      :MLOAD(pairing_T24_21_x)
    $ => B      :MLOAD(pairing_T24_21_y)
    A           :MSTORE(mulFp12BN254_b21_x)
    B           :MSTORE(mulFp12BN254_b21_y)
    $ => A      :MLOAD(pairing_T24_22_x)
    $ => B      :MLOAD(pairing_T24_22_y)
    A           :MSTORE(mulFp12BN254_b22_x)
    B           :MSTORE(mulFp12BN254_b22_y)
    $ => A      :MLOAD(pairing_T24_23_x)
    $ => B      :MLOAD(pairing_T24_23_y)
    A           :MSTORE(mulFp12BN254_b23_x)
    B           :MSTORE(mulFp12BN254_b23_y)
                :CALL(mulFp12BN254)
    ; ===========================================

    ; FINAL: Assing the result. I do not need it, I can just return the last value, but I think it's better to keep names
    $ => A      :MLOAD(mulFp12BN254_c11_x)
    $ => B      :MLOAD(mulFp12BN254_c11_y)
    A           :MSTORE(pairing_f11_x)
    B           :MSTORE(pairing_f11_y)
    $ => A      :MLOAD(mulFp12BN254_c12_x)
    $ => B      :MLOAD(mulFp12BN254_c12_y)
    A           :MSTORE(pairing_f12_x)
    B           :MSTORE(pairing_f12_y)
    $ => A      :MLOAD(mulFp12BN254_c13_x)
    $ => B      :MLOAD(mulFp12BN254_c13_y)
    A           :MSTORE(pairing_f13_x)
    B           :MSTORE(pairing_f13_y)
    $ => A      :MLOAD(mulFp12BN254_c21_x)
    $ => B      :MLOAD(mulFp12BN254_c21_y)
    A           :MSTORE(pairing_f21_x)
    B           :MSTORE(pairing_f21_y)
    $ => A      :MLOAD(mulFp12BN254_c22_x)
    $ => B      :MLOAD(mulFp12BN254_c22_y)
    A           :MSTORE(pairing_f22_x)
    B           :MSTORE(pairing_f22_y)
    $ => A      :MLOAD(mulFp12BN254_c23_x)
    $ => B      :MLOAD(mulFp12BN254_c23_y)
    A           :MSTORE(pairing_f23_x)
    B           :MSTORE(pairing_f23_y)

    0 => B     :JMP(pairing_end)

; ERRORS
pairing_P_is_not_in_G1:
    1 => B      :JMP(pairing_error)

pairing_Q_is_not_in_G2:
    2 => B      :JMP(pairing_error)

pairing_error:
        0 => A

pairing_end:
        $ => RR     :MLOAD(pairing_RR)
        ${dump(B)}
        :RETURN

INCLUDE "./FPBN254/addFpBN254.zkasm"
INCLUDE "./FPBN254/subFpBN254.zkasm"
INCLUDE "./FPBN254/mulFpBN254.zkasm"
INCLUDE "./FPBN254/squareFpBN254.zkasm"
INCLUDE "./FPBN254/invFpBN254.zkasm"

INCLUDE "./FP2BN254/addFp2BN254.zkasm"
INCLUDE "./FP2BN254/subFp2BN254.zkasm"
INCLUDE "./FP2BN254/mulFp2BN254.zkasm"
INCLUDE "./FP2BN254/squareFp2BN254.zkasm"
INCLUDE "./FP2BN254/escalarMulFp2BN254.zkasm"
INCLUDE "./FP2BN254/invFp2BN254.zkasm"

INCLUDE "./FP6BN254/addFp6BN254.zkasm"
INCLUDE "./FP6BN254/subFp6BN254.zkasm"
INCLUDE "./FP6BN254/mulFp6BN254.zkasm"
INCLUDE "./FP6BN254/squareFp6BN254.zkasm"
INCLUDE "./FP6BN254/inverseFp6BN254.zkasm"

INCLUDE "./FP12BN254/mulFp12BN254.zkasm"
INCLUDE "./FP12BN254/squareFp12BN254.zkasm"
INCLUDE "./FP12BN254/inverseFp12BN254.zkasm"
INCLUDE "./FP12BN254/expFp12BN254.zkasm"
INCLUDE "./FP12BN254/frobFp12BN254.zkasm"
INCLUDE "./FP12BN254/frob2Fp12BN254.zkasm"
INCLUDE "./FP12BN254/frob3Fp12BN254.zkasm"

INCLUDE "./BN254/addPointBN254.zkasm"
INCLUDE "./BN254/escalarMulBN254.zkasm"
INCLUDE "./BN254/lineSamePointsBN254.zkasm"
INCLUDE "./BN254/lineDiffPointsBN254.zkasm"

INCLUDE "loopLengthBN254.zkasm"